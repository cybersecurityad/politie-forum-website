
<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes, user-scalable=yes">
<!-- Advanced SEO Meta Tags for Google & Bing -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes, user-scalable=yes">

<!-- Primary Meta Tags -->
<title>Politie-Forum.nl — Onafhankelijk Politie Nieuws Forum, Discussies en Analyses</title>
<meta name="title" content="Politie-Forum.nl — Onafhankelijk Politie Nieuws Forum, Discussies en Analyses">
<meta name="description" content="Laatste politienieuws uit Nederland. Actuele incidenten, opsporingen en veiligheidstips.">
<meta name="keywords" content="politie forum, politienieuws Nederland, veiligheidsforum, politieberichten, misdaadnieuws, opsporingen, buurtpreventie, woningbeveiliging, verkeersveiligheid, cybercrime, drugsbestrijding">
<meta name="author" content="Politie-Forum.nl">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="language" content="Dutch">
<meta name="geo.region" content="NL">
<meta name="geo.country" content="Netherlands">
<meta name="geo.placename" content="Nederland">
<meta name="ICBM" content="52.1326, 5.2913">
<meta name="revisit-after" content="1 days">

<!-- Verificatie -->
<meta name="google-site-verification" content="GOOGLE_CODE_HIER">
<meta name="msvalidate.01" content="BING_CODE_HIER">

<!-- News Specific Meta Tags -->
<meta name="news_keywords" content="politie, misdaad, veiligheid, opsporing, incidenten, Nederland">
<meta name="article:author" content="Politie-Forum.nl">
<meta name="article:publisher" content="https://www.facebook.com/politieforymnederland">
<meta name="article:section" content="Nieuws">
<meta name="article:tag" content="Politie">
<meta name="article:tag" content="Veiligheid">
<meta name="article:tag" content="Nederland">

<!-- Canonical URL -->
<link rel="canonical" href="https://politie-forum.nl/">

<!-- Alternate Language Versions -->
<link rel="alternate" hreflang="nl" href="https://politie-forum.nl/">
<link rel="alternate" hreflang="x-default" href="https://politie-forum.nl/">

<!-- DNS Prefetch for Performance -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com">
<link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com">
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
<link rel="dns-prefetch" href="//www.gstatic.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">

<!-- Preconnect to external domains -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://stackpath.bootstrapcdn.com">
<link rel="preconnect" href="https://cdnjs.cloudflare.com">
<link rel="preconnect" href="https://www.gstatic.com">
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>

<!-- Preload critical resources -->
<link rel="preload" href="/favicon.svg" as="image" type="image/svg+xml">
<link rel="preload" href="/assets/logo-clean-600.png" as="image" type="image/png">
<link rel="preload" href="/og/og-1200x630.jpg" as="image" type="image/jpeg">
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" as="style">

<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

<!-- Favicon and App Icons -->
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32.png">
<link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180.png">
<link rel="manifest" href="/manifest.json">

<!-- Windows tiles -->
<meta name="msapplication-config" content="/browserconfig.xml">

<!-- Safari pinned tab -->
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00008b">
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="Politie-Forum.nl">
<meta property="og:title" content="Politie-Forum.nl — Onafhankelijk Politie Nieuws Forum, Discussies en Analyses">
<meta property="og:description" content="Actueel politienieuws, opsporingen en veiligheid.">
<meta property="og:url" content="https://politie-forum.nl/">
<meta property="og:image" content="https://politie-forum.nl/og/og-1200x630.jpg">
<meta property="og:image:secure_url" content="https://politie-forum.nl/og/og-1200x630.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="Politie-Forum.nl - Nederlands grootste politie forum voor nieuws, discussies en veiligheidsinformatie">
<meta property="og:locale" content="nl_NL">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Politie-Forum.nl — Onafhankelijk Politie Nieuws Forum, Discussies en Analyses">
<meta name="twitter:description" content="Actueel politienieuws, opsporingen en veiligheid.">
<meta name="twitter:image" content="https://politie-forum.nl/og/twitter-1200x600.jpg">

<!-- LinkedIn -->
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

<!-- WhatsApp -->
<meta property="og:image:width" content="400">
<meta property="og:image:height" content="400">

<!-- Additional SEO Meta Tags -->
<meta name="theme-color" content="#00008b">
<meta name="msapplication-TileColor" content="#00008b">
<meta name="msapplication-config" content="browserconfig.xml">
<meta name="application-name" content="Politie-Forum.nl">
<meta name="apple-mobile-web-app-title" content="Politie-Forum.nl">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="mobile-web-app-capable" content="yes">
<meta name="HandheldFriendly" content="true">
<meta name="format-detection" content="telephone=no">

<!-- Security Headers -->
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">

<!-- Performance and Caching -->
<meta http-equiv="Cache-Control" content="max-age=3600, must-revalidate">
<meta http-equiv="Expires" content="Mon, 29 Aug 2025 12:00:00 GMT">
<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Politie-Forum.nl",
  "url": "https://politie-forum.nl/",
  "description": "Laatste politienieuws uit Nederland. Actuele incidenten, opsporingen en veiligheidstips.",
  "inLanguage": "nl-NL",
  "publisher": {
    "@type": "Organization",
    "name": "Politie-Forum.nl",
    "url": "https://politie-forum.nl/",
    "logo": {
      "@type": "ImageObject",
      "url": "https://politie-forum.nl/assets/logo-clean-600.png",
      "width": 600,
      "height": 600
    },
    "sameAs": [
      "https://www.facebook.com/politieforymnederland",
      "https://twitter.com/politieforum_nl"
    ]
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://politie-forum.nl/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>

<!-- Organization Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Politie-Forum.nl",
  "url": "https://politie-forum.nl/",
  "logo": "https://politie-forum.nl/assets/logo-clean-600.png",
  "description": "Onafhankelijk platform voor politienieuws en veiligheidsinformatie in Nederland",
  "foundingDate": "2024",
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer service",
    "email": "info@politie-forum.nl"
  },
  "sameAs": [
    "https://www.facebook.com/politieforymnederland",
    "https://twitter.com/politieforum_nl"
  ],
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "NL",
    "addressLocality": "Nederland"
  }
}
</script>
<style>
/* Base Styles */
:root {
--primary-color: #00008b; /* Police blue */
--primary-color-dark: #002d6b;
--primary-color-light: #1a56a7;
--secondary-color: #f4f6f9;
--text-color: #333;
--text-color-light: #666;
--text-color-dark: #000;
--white: #fff;
--gray-light: #f0f4f8;
--gray-medium: #dde4ed;
--border-radius: 10px;
--box-shadow: 0 2px 5px rgba(0,0,0,0.1);
--box-shadow-hover: 0 4px 8px rgba(0,0,0,0.15);
--transition-fast: 0.2s;
--transition-medium: 0.3s;
--font-family: 'Poppins', sans-serif;
--accent-color: #f60707; /* Police accent red */
--accent-light: #ff3b3b;
--alert-bg-color: #ff0000;
--alert-border-color: #ff5555;
--alert-shadow-color: rgba(255, 0, 0, 0.4);
}
/* Dark mode variables */
.dark-mode {
--secondary-color: #121212;
--text-color: #e0e0e0;
--text-color-light: #999;
--text-color-dark: #fff;
--white: #1e1e1e;
--gray-light: #2a2a2a;
--gray-medium: #444;
--box-shadow: 0 2px 8px rgba(0,0,0,0.3);
--box-shadow-hover: 0 4px 12px rgba(0,0,0,0.4);
}
*, *::before, *::after {
box-sizing: border-box;
}
html {
font-size: 62.5%; /* 10px = 1rem */
scroll-behavior: smooth;
}
body {
font-family: var(--font-family);
font-size: 1.6rem;
margin: 0;
padding: 0;
background-color: var(--secondary-color);
display: flex;
flex-direction: column;
min-height: 100vh;
color: var(--text-color);
line-height: 1.6;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
}
img {
max-width: 100%;
height: auto;
display: block;
}
a {
color: var(--primary-color);
text-decoration: none;
transition: color var(--transition-fast);
}
a:hover {
color: var(--primary-color-light);
}
button, input, select, textarea {
font-family: inherit;
font-size: inherit;
line-height: inherit;
}
/* Skip to content link for accessibility */
.skip-to-content {
position: absolute;
left: -9999px;
top: auto;
width: 1px;
height: 1px;
overflow: hidden;
}
.skip-to-content:focus {
position: fixed;
left: 0;
top: 0;
width: auto;
height: auto;
padding: 1rem;
background: var(--primary-color);
color: var(--white);
z-index: 9999;
overflow: auto;
}
/* Header Styles */
.site-header {
background: var(--primary-color);
padding: 1rem;
color: var(--white);
box-shadow: var(--box-shadow);
display: flex;
justify-content: space-between;
align-items: center;
width: 100%;
z-index: 1001;
position: relative;
}
.logo-container {
display: flex;
align-items: center;
gap: 1rem;
}
.logo-container img {
width: 48px;
height: 48px;
margin-right: 0;
border-radius: 8px;
box-shadow: 0 2px 8px rgba(0, 0, 139, 0.3);
transition: transform 0.3s ease, box-shadow 0.3s ease;
background: white;
padding: 4px;
}
.logo-container img:hover {
transform: scale(1.05);
box-shadow: 0 4px 12px rgba(0, 0, 139, 0.4);
}
.logo-container a {
color: var(--white);
text-decoration: none;
font-size: 1.8rem;
font-weight: 700;
letter-spacing: -0.02em;
text-shadow: 0 2px 4px rgba(0,0,0,0.3);
transition: color 0.3s ease;
}
.logo-container a:hover {
color: #e6e6e6;
}
.nav-links {
display: flex;
gap: 1.5rem;
}
.nav-links a {
color: var(--white);
font-size: 1.4rem;
text-decoration: none;
padding: 0.4rem 0.8rem;
border-radius: 0.4rem;
transition: background-color var(--transition-medium);
font-weight: 500;
}
.nav-links a:hover, .nav-links a:focus {
background-color: rgba(255, 255, 255, 0.1);
outline: none;
}
.nav-links a:active {
background-color: rgba(255, 255, 255, 0.2);
}
.nav-links a i {
margin-right: 0.5rem;
}
/* Mobile menu */
.mobile-menu-toggle {
display: none;
background: none;
border: none;
color: var(--white);
font-size: 1.8rem;
cursor: pointer;
padding: 0.5rem;
}
.mobile-menu-toggle:focus {
outline: 2px solid rgba(255, 255, 255, 0.5);
border-radius: 0.4rem;
}
/* Main Content Layout */
.main-container {
max-width: 1200px;
margin: 0 auto;
width: 100%;
display: flex;
gap: 3rem;
padding: 2rem;
flex: 1;
}
.content-area {
flex: 3;
}
.content-area h1 {
color: var(--primary-color);
font-size: 3.2rem;
font-weight: 700;
margin-bottom: 1rem;
line-height: 1.2;
}
.content-area h2 {
color: var(--text-color);
font-size: 2.8rem;
font-weight: 600;
margin-bottom: 1.5rem;
line-height: 1.3;
}
/* Forum specific styles */
.forum-container {
background: var(--white);
border-radius: var(--border-radius);
box-shadow: var(--box-shadow);
overflow: hidden;
margin-bottom: 2rem;
}
.forum-header {
background: white;
color: #1e3a8a;
padding: 2rem;
position: relative;
border: 5px solid #1e3a8a;
border-radius: 0.5rem;
margin-bottom: 3rem;
}
.forum-header h1 {
font-size: 2.4rem;
margin: 0;
color: #1e3a8a;
}
/* Make forum description text darker blue and bigger */
.forum-description {
margin-top: 0.8rem;
font-size: 1.6rem;
opacity: 1;
color: #1e2c5f !important;
font-weight: 500;
}
/* Forum Categories */
.category {
border-bottom: 1px solid var(--gray-light);
}
.category:last-child {
border-bottom: none;
}
.category-header {
padding: 1rem 1.5rem;
background-color: var(--primary-color);
font-weight: 600;
color: white;
cursor: pointer;
display: flex;
justify-content: space-between;
align-items: center;
border-radius: 0.5rem;
transition: background-color 0.3s ease;
user-select: none;
}
.category-header:hover {
background-color: var(--primary-color-dark);
}
.category-header h2 {
color: white;
font-size: 1.8rem;
margin: 0;
}
.category-header i {
color: white;
}
.forum-section {
border-bottom: 1px solid var(--gray-light);
transition: background-color var(--transition-fast);
}
.forum-section:last-child {
border-bottom: none;
}
/* Create embossed boxes for forum subjects */
.forum-section-link {
display: flex;
padding: 1.5rem 2rem;
text-decoration: none;
color: inherit;
gap: 2rem;
width: 100%;
background: var(--white);
border-radius: 8px;
margin: 1rem 0;
box-shadow: 0 1px 3px rgba(0,0,0,0.12), 
inset 0 1px 0 rgba(255,255,255,0.7),
inset 0 -1px 0 rgba(0,0,0,0.05);
border: 1px solid rgba(0,0,0,0.05);
}
.forum-section-link:hover {
background-color: var(--gray-light);
text-decoration: none;
color: inherit;
transform: translateY(-2px);
box-shadow: 0 4px 6px rgba(0,0,0,0.1), 
inset 0 1px 0 rgba(255,255,255,0.7),
inset 0 -1px 0 rgba(0,0,0,0.05);
}
.forum-icon {
font-size: 2.2rem;
color: var(--primary-color);
width: 4rem;
text-align: center;
}
.forum-content {
flex: 1;
}
.forum-title {
font-weight: 600;
font-size: 1.6rem;
margin-bottom: 0.5rem;
color: var(--primary-color);
}
.forum-description {
color: var(--text-color-light);
margin-bottom: 0.5rem;
font-size: 1.4rem;
}
.forum-stats {
display: flex;
gap: 2rem;
margin-top: 1rem;
font-size: 1.2rem;
color: var(--text-color-light);
}
.forum-stat {
display: flex;
align-items: center;
gap: 0.5rem;
}
.forum-latest {
width: 20rem;
text-align: right;
font-size: 1.2rem;
color: var(--text-color-light);
}
.latest-time {
font-style: italic;
margin-top: 0.3rem;
}
/* Auth Modal */
.modal {
display: none;
position: fixed;
z-index: 1000;
left: 0;
top: 0;
width: 100%;
height: 100%;
overflow: auto;
background-color: rgba(0,0,0,0.5);
}
.modal-content {
background-color: var(--white);
margin: 10% auto;
padding: 2rem;
border-radius: var(--border-radius);
max-width: 50rem;
position: relative;
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
animation: modalFadeIn 0.3s;
}
@keyframes modalFadeIn {
from {opacity: 0; transform: translateY(-20px);}
to {opacity: 1; transform: translateY(0);}
}
.close-btn {
position: absolute;
top: 1.5rem;
right: 2rem;
color: var(--text-color-light);
font-size: 2.2rem;
font-weight: bold;
cursor: pointer;
transition: color var(--transition-fast);
}
.close-btn:hover {
color: var(--text-color);
}
.modal-header {
margin-bottom: 1.5rem;
}
.modal-title {
color: var(--primary-color);
font-size: 2rem;
margin: 0;
}
.form-tabs {
display: flex;
margin-bottom: 1.5rem;
border-bottom: 1px solid var(--gray-light);
}
.form-tab {
padding: 0.8rem 1.5rem;
cursor: pointer;
border-bottom: 2px solid transparent;
transition: all var(--transition-fast);
}
.form-tab.active {
color: var(--primary-color);
border-bottom-color: var(--primary-color);
font-weight: 500;
}
.form-control {
width: 100%;
padding: 1rem;
margin-bottom: 1.5rem;
border: 1px solid var(--gray-medium);
border-radius: 0.4rem;
font-family: inherit;
background-color: var(--white);
color: var(--text-color);
}
.form-control:focus {
border-color: var(--primary-color);
outline: none;
box-shadow: 0 0 0 2px rgba(0, 62, 145, 0.1);
}
.form-group {
margin-bottom: 1.5rem;
}
.form-group label {
display: block;
margin-bottom: 0.5rem;
color: var(--text-color);
}
.auth-btn {
width: 100%;
background-color: var(--primary-color);
color: var(--white);
border: none;
padding: 1rem;
border-radius: 0.4rem;
cursor: pointer;
font-weight: 500;
transition: background-color var(--transition-fast);
}
.auth-btn:hover {
background-color: var(--primary-color-dark);
}
.form-footer {
text-align: center;
margin-top: 1.5rem;
font-size: 1.2rem;
color: var(--text-color-light);
}
.form-footer a {
color: var(--primary-color);
}
.forgot-password {
text-align: right;
font-size: 1.2rem;
margin-top: -1rem;
margin-bottom: 1.5rem;
}
.forgot-password a {
color: var(--primary-color);
}
.auth-error {
color: #dc3545;
background-color: #f8d7da;
padding: 1rem;
border-radius: 0.4rem;
margin-bottom: 1.5rem;
display: none;
}
/* New Thread Modal */
.new-thread-btn {
background-color: var(--primary-color);
color: var(--white);
border: none;
padding: 0.8rem 1.5rem;
border-radius: 0.4rem;
display: flex;
align-items: center;
gap: 0.5rem;
font-weight: 500;
cursor: pointer;
margin-bottom: 2rem;
}
.new-thread-btn:hover {
background-color: var(--primary-color-dark);
}
.thread-form {
margin-top: 1rem;
}
/* Sidebar Content */
.sidebar-content {
flex: 1;
}
/* Category navigation */
.categories-widget {
background: var(--white);
border-radius: var(--border-radius);
padding: 2rem;
margin-bottom: 2rem;
box-shadow: var(--box-shadow);
}
.categories-list {
list-style: none;
padding: 0;
margin: 0;
}
.category-item {
margin-bottom: 1rem;
}
.category-item a {
display: flex;
align-items: center;
color: var(--text-color);
text-decoration: none;
padding: 0.8rem 1rem;
border-radius: 0.4rem;
transition: background-color var(--transition-medium);
}
.category-item a:hover, .category-item a:focus {
background-color: var(--gray-light);
outline: none;
}
.category-item i {
margin-right: 1rem;
width: 2rem;
text-align: center;
color: var(--primary-color);
}
/* Widget Styles */
.widget {
background: var(--white);
border-radius: var(--border-radius);
padding: 2rem;
margin-bottom: 2rem;
box-shadow: var(--box-shadow);
}
.widget-title {
color: var(--primary-color);
font-size: 2rem;
font-weight: 600;
margin-bottom: 1.5rem;
padding-bottom: 1rem;
border-bottom: 1px solid var(--gray-light);
}
/* User widget */
.user-widget {
background: var(--primary-color);
color: var(--white);
border-radius: var(--border-radius);
padding: 2rem;
margin-bottom: 2rem;
box-shadow: var(--box-shadow);
}
.user-widget-title {
color: var(--white);
font-size: 2rem;
font-weight: 600;
margin-bottom: 1.5rem;
padding-bottom: 1rem;
border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}
.user-content {
display: flex;
flex-direction: column;
align-items: center;
}
.user-avatar-lg {
width: 6rem;
height: 6rem;
border-radius: 50%;
background-color: var(--white);
display: flex;
align-items: center;
justify-content: center;
color: var(--primary-color);
font-weight: 600;
font-size: 2.6rem;
margin-bottom: 1rem;
}
.user-name-lg {
color: var(--white);
font-weight: 500;
font-size: 1.8rem;
margin-bottom: 1.5rem;
}
.login-btn-lg {
background: var(--white);
color: var(--primary-color);
border: none;
padding: 1rem 2rem;
border-radius: 0.4rem;
font-weight: 500;
cursor: pointer;
transition: background-color var(--transition-fast);
font-size: 1.4rem;
width: 100%;
text-align: center;
}
.login-btn-lg:hover {
background-color: var(--gray-light);
}
.logout-btn-lg {
background: rgba(255, 255, 255, 0.2);
color: var(--white);
border: none;
padding: 1rem 2rem;
border-radius: 0.4rem;
cursor: pointer;
transition: background-color var(--transition-fast);
font-size: 1.4rem;
margin-top: 1rem;
width: 100%;
text-align: center;
}
.logout-btn-lg:hover {
background-color: rgba(255, 255, 255, 0.3);
}
/* Search Widget */
.search-form {
display: flex;
flex-direction: column;
}
.search-form input {
width: 100%;
padding: 1rem;
border: 1px solid var(--gray-medium);
border-radius: 0.4rem;
margin-bottom: 1rem;
transition: border-color var(--transition-fast);
background-color: var(--white);
color: var(--text-color);
}
.search-form input:focus {
border-color: var(--primary-color);
outline: none;
box-shadow: 0 0 0 2px rgba(0, 62, 145, 0.1);
}
.search-form button {
width: 100%;
padding: 1rem;
background: var(--primary-color);
color: var(--white);
border: none;
border-radius: 0.4rem;
cursor: pointer;
font-weight: 500;
transition: background-color var(--transition-fast);
}
.search-form button:hover, .search-form button:focus {
background-color: var(--primary-color-dark);
outline: none;
}
/* Recent Posts */
.recent-post {
display: flex;
align-items: flex-start;
margin-bottom: 1.5rem;
padding: 1rem;
border: 1px solid var(--gray-light);
border-radius: 0.4rem;
background: var(--white);
transition: background-color var(--transition-fast);
}
.recent-post:hover, .recent-post:focus-within {
background: var(--gray-light);
}
.recent-post-content {
width: 100%;
}
.recent-post-content h3 {
font-size: 1.4rem;
margin: 0;
line-height: 1.4;
}
.recent-post-content a {
color: var(--primary-color);
text-decoration: none;
font-weight: 500;
transition: color var(--transition-fast);
}
.recent-post-content a:hover, .recent-post-content a:focus {
color: var(--primary-color-light);
text-decoration: underline;
outline: none;
}
/* Popular Tags Widget */
.tags-widget {
display: flex;
flex-wrap: wrap;
gap: 0.8rem;
}
.tag-item {
background-color: var(--gray-light);
padding: 0.5rem 1.2rem;
border-radius: 1.5rem;
font-size: 1.3rem;
transition: background-color var(--transition-fast);
cursor: pointer;
display: inline-flex;
align-items: center;
}
.tag-item:hover, .tag-item:focus {
background-color: var(--gray-medium);
outline: none;
}
.tag-count {
background-color: var(--primary-color);
color: var(--white);
padding: 0.2rem 0.6rem;
border-radius: 1rem;
font-size: 1rem;
margin-left: 0.5rem;
display: inline-block;
}
/* Newsletter Widget */
.newsletter-form {
display: flex;
flex-direction: column;
}
.newsletter-form input {
width: 100%;
padding: 1rem;
border: 1px solid var(--gray-medium);
border-radius: 0.4rem;
margin-bottom: 1rem;
transition: border-color var(--transition-fast);
background-color: var(--white);
color: var(--text-color);
}
.newsletter-form input:focus {
border-color: var(--primary-color);
outline: none;
box-shadow: 0 0 0 2px rgba(0, 62, 145, 0.1);
}
.newsletter-form button {
width: 100%;
padding: 1rem;
background: var(--primary-color);
color: var(--white);
border: none;
border-radius: 0.4rem;
cursor: pointer;
font-weight: 500;
transition: background-color var(--transition-fast);
}
.newsletter-form button:hover, .newsletter-form button:focus {
background-color: var(--primary-color-dark);
outline: none;
}
/* Footer */
.footer {
background: var(--primary-color);
color: var(--white);
padding: 4rem 2rem 2rem;
margin-top: 2rem;
}
.footer-container {
max-width: 1200px;
margin: 0 auto;
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 3rem;
}
.footer-section h2 {
color: var(--white);
font-size: 1.8rem;
margin-bottom: 2rem;
position: relative;
padding-bottom: 1rem;
}
.footer-section h2::after {
content: '';
position: absolute;
bottom: 0;
left: 0;
width: 5rem;
height: 2px;
background-color: var(--white);
}
.footer-section p {
color: rgba(255, 255, 255, 0.7);
margin-bottom: 1.5rem;
font-size: 1.4rem;
line-height: 1.6;
}
/* Force social media icons to be visible in both light and dark modes */
.footer-social a {
color: var(--white) !important;
background-color: var(--primary-color) !important;
}
.footer-social a:hover, .footer-social a:focus {
opacity: 0.8 !important;
background-color: var(--primary-color-dark) !important;
}
.footer-links {
list-style: none;
padding: 0;
margin: 0;
}
.footer-links li {
margin-bottom: 1rem;
}
.footer-links a {
color: rgba(255, 255, 255, 0.7);
text-decoration: none;
transition: color var(--transition-fast);
font-size: 1.4rem;
display: inline-block;
}
.footer-links a:hover, .footer-links a:focus {
color: var(--white);
outline: none;
}
.footer-social {
display: flex;
gap: 1.5rem;
margin-bottom: 2rem;
}
.footer-social a {
color: var(--white);
font-size: 1.8rem;
transition: opacity var(--transition-fast);
text-decoration: none;
display: flex;
align-items: center;
justify-content: center;
width: 3.6rem;
height: 3.6rem;
background-color: rgba(255, 255, 255, 0.1);
border-radius: 50%;
}
.footer-social a:hover, .footer-social a:focus {
opacity: 0.8;
background-color: rgba(255, 255, 255, 0.2);
outline: none;
}
.footer-bottom {
text-align: center;
padding-top: 2rem;
margin-top: 2rem;
border-top: 1px solid rgba(255, 255, 255, 0.1);
}
.footer-bottom p {
margin: 0;
color: rgba(255, 255, 255, 0.7);
font-size: 1.4rem;
}
.footer-bottom a {
color: rgba(255, 255, 255, 0.7);
text-decoration: none;
transition: color var(--transition-fast);
}
.footer-bottom a:hover, .footer-bottom a:focus {
color: var(--white);
text-decoration: underline;
outline: none;
}
/* Pagination */
.pagination {
display: flex;
justify-content: center;
margin: 3rem 0;
flex-wrap: wrap;
gap: 0.5rem;
}
.pagination-btn {
padding: 0.8rem 1.5rem;
background-color: var(--white);
border: 1px solid var(--gray-medium);
margin: 0 0.5rem;
cursor: pointer;
border-radius: 0.4rem;
transition: all var(--transition-fast);
font-size: 1.4rem;
}
.pagination-btn.active {
background-color: var(--primary-color);
color: var(--white);
border-color: var(--primary-color);
}
.pagination-btn:hover, .pagination-btn:focus {
background-color: var(--gray-light);
outline: none;
}
.pagination-btn.active:hover, .pagination-btn.active:focus {
background-color: var(--primary-color-dark);
}
/* Loading indicator */
.loading {
text-align: center;
padding: 2rem;
}
.loading-spinner {
display: inline-block;
width: 4rem;
height: 4rem;
border: 0.4rem solid var(--gray-light);
border-top: 0.4rem solid var(--primary-color);
border-radius: 50%;
animation: spin 1s linear infinite;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
/* Emergency numbers widget */
.emergency-widget {
background-color: var(--accent-light);
color: var(--white);
border-radius: var(--border-radius);
padding: 1.5rem;
margin-bottom: 2rem;
}
.emergency-widget h2 {
color: var(--white);
font-size: 1.8rem;
margin-bottom: 1rem;
font-weight: 600;
}
.emergency-numbers {
list-style: none;
padding: 0;
margin: 0;
}
.emergency-numbers li {
display: flex;
align-items: center;
margin-bottom: 1rem;
font-size: 1.5rem;
}
.emergency-numbers li i {
margin-right: 1rem;
font-size: 1.8rem;
}
.emergency-numbers a {
color: var(--white);
text-decoration: none;
font-weight: 500;
}
.emergency-numbers a:hover,
.emergency-numbers a:focus {
text-decoration: underline;
}
/* Breadcrumbs */
.breadcrumbs {
display: flex;
align-items: center;
flex-wrap: wrap;
margin-bottom: 2rem;
font-size: 1.4rem;
color: var(--text-color-light);
}
.breadcrumbs a {
color: var(--primary-color);
text-decoration: none;
}
.breadcrumbs a:hover, .breadcrumbs a:focus {
text-decoration: underline;
outline: none;
}
.breadcrumbs .separator {
margin: 0 0.5rem;
}
.breadcrumbs .current {
font-weight: 500;
color: var(--text-color);
}
/* Accessibility Enhancements */
.visually-hidden {
position: absolute;
width: 1px;
height: 1px;
padding: 0;
margin: -1px;
overflow: hidden;
clip: rect(0, 0, 0, 0);
white-space: nowrap;
border: 0;
}
:focus {
outline: 3px solid rgba(0, 62, 145, 0.3);
outline-offset: 2px;
}
:focus:not(:focus-visible) {
outline: none;
}
:focus-visible {
outline: 3px solid rgba(0, 62, 145, 0.5);
outline-offset: 2px;
}
/* Dark mode text color adjustments */
.dark-mode .site-header a,
.dark-mode .nav-links a,
.dark-mode .logo-container a {
color: white !important;
font-weight: bold !important;
}
/* Header navigation items */
.dark-mode #navLinks a,
.dark-mode .nav-links a {
color: white !important;
font-weight: bold !important;
}
/* Search text */
.dark-mode .search-form button,
.dark-mode .widget-title:contains("Zoeken") {
color: white !important;
font-weight: bold !important;
}
/* Forum titles */
.dark-mode .forum-title,
.dark-mode .content-area h1 {
color: white !important;
font-weight: bold !important;
}
/* Category titles */
.dark-mode .widget-title:contains("Categorieën"),
.dark-mode .category-item a {
color: white !important;
font-weight: bold !important;
}
/* Recent posts text */
.dark-mode .recent-post-content a,
.dark-mode .recent-post-content h3 {
color: white !important;
}
/* Footer section titles */
.dark-mode .footer-section h2 {
color: white !important;
font-weight: bold !important;
}
/* Footer navigation links - make them more visible */
.dark-mode .footer-links a {
color: rgba(255, 255, 255, 0.9) !important;
}
/* Dark mode specific override */
.dark-mode .forum-section-link:hover {
background-color: #2a2a2a !important;
}
.dark-mode .category-header {
background-color: #1e40af !important;
color: white !important;
}
.dark-mode .category-header:hover {
background-color: #1d4ed8 !important;
}
.dark-mode .category-header h2 {
color: white !important;
}
.dark-mode .category-header i {
color: white !important;
}
.dark-mode .forum-header {
background: #2a2a2a !important;
color: white !important;
border-color: #1e40af !important;
}
.dark-mode .forum-header h1 {
color: white !important;
}
.dark-mode .forum-header .forum-description {
color: white !important;
}
.dark-mode .forum-description,
.dark-mode .forum-stats,
.dark-mode .forum-latest,
.dark-mode .latest-time {
color: #e0e0e0 !important;
}
.dark-mode .modal-content,
.dark-mode .form-control {
background-color: #1e1e1e !important;
color: #e0e0e0 !important;
}
.dark-mode .form-control {
border-color: #444 !important;
}
.dark-mode .form-tab.active {
color: white !important;
border-bottom-color: white !important;
}
.dark-mode .close-btn {
color: white !important;
}
.dark-mode .form-group label {
color: #e0e0e0 !important;
}
/* News Flasher Style */
.news-flasher {
background-color: #f60707;
color: white;
display: flex;
height: 40px;
align-items: center;
box-shadow: 0 2px 5px rgba(0,0,0,0.2);
font-family: 'Poppins', sans-serif;
position: relative;
width: 100%;
box-sizing: border-box;
border: 2px solid #fff; 
}
.flasher-label {
background-color: #cc0000;
color: white;
font-weight: bold;
padding: 0 15px;
height: 100%;
display: flex;
align-items: center;
font-size: 16px;
min-width: 150px;
justify-content: center;
position: relative;
z-index: 2;
text-transform: uppercase;
animation: pulse-bg 1.5s infinite, blink-text 1s infinite; 
border-right: 2px solid #fff; 
}
/* Blinking text animation */
@keyframes blink-text {
0%, 49% { opacity: 1; }
50%, 100% { opacity: 0.5; }
}
@keyframes pulse-bg {
0%, 100% { background-color: #cc0000; }
50% { background-color: #ff0000; }
}
.flasher-label::after {
content: '';
position: absolute;
right: -10px;
top: 50%;
transform: translateY(-50%);
width: 0;
height: 0;
border-top: 10px solid transparent;
border-bottom: 10px solid transparent;
border-left: 10px solid #cc0000;
z-index: 2;
animation: pulse-arrow 1.5s infinite;
}  
/* Ensure the arrow color matches the background */
@keyframes pulse-arrow {
0%, 100% { border-left-color: #cc0000; }
50% { border-left-color: #ff0000; }
}
.flasher-container {
overflow: hidden;
position: relative;
height: 100%;
flex: 1;
margin-left: 10px;
}
.flasher-content {
display: flex;
align-items: center;
position: absolute;
white-space: nowrap;
animation: scroll-news 100s linear infinite;
height: 100%;
padding-left: 100%;
font-weight: 900;
}
.flasher-content:hover {
animation-play-state: paused;
}
@keyframes scroll-news {
0% { transform: translateX(0); }
100% { transform: translateX(-100%); }
}
.flasher-content span {
padding: 0 10px;
font-weight: 700;
font-size: 16px;
}
.flasher-separator {
color: rgba(255, 255, 255, 0.7);
font-size: 18px;
}
/* Mobile adjustments */
@media (max-width: 992px) {
.main-container {
flex-direction: column;
padding: 1.5rem;
}
.content-area {
margin-bottom: 2rem;
}
.sidebar-content {
width: 100%;
}
.footer-container {
grid-template-columns: repeat(2, 1fr);
}
.forum-latest {
display: none;
}
}
@media (max-width: 768px) {
html {
font-size: 55%;
}
.site-header {
flex-direction: column;
align-items: flex-start;
padding: 1rem;
}
.logo-container {
margin-bottom: 1rem;
width: 100%;
justify-content: space-between;
align-items: center;
}
.nav-links {
display: none;
width: 100%;
flex-direction: column;
gap: 0.5rem;
}
.nav-links.show {
display: flex;
}
.mobile-menu-toggle {
display: block;
position: absolute;
top: 1.5rem;
right: 1.5rem;
}
.forum-header {
padding: 1.5rem;
}
.forum-section-link {
flex-direction: column;
gap: 1rem;
}
.forum-icon {
width: auto;
}
.forum-stats {
flex-direction: column;
gap: 0.5rem;
}
.flasher-label {
min-width: 80px;
font-size: 14px;
}
.flasher-content span {
font-size: 14px;
}
.footer-container {
grid-template-columns: 1fr;
gap: 2rem;
}
}
@media (max-width: 480px) {
html {
font-size: 52%;
}
.forum-section-link {
padding: 1rem;
}
.modal-content {
width: 90%;
padding: 1.5rem;
}
}
/* Fix forum description color in subject boxes */
.forum-section-link .forum-description {
color: var(--primary-color) !important; 
opacity: 0.8;
}
/* Ensure login button in header has proper styling */
.nav-links .login-btn {
background: rgba(255, 255, 255, 0.2);
color: var(--white);
border: none;
padding: 0.8rem 1.2rem;
border-radius: 0.4rem;
font-weight: 500;
cursor: pointer;
margin-left: 1rem;
font-size: 1.4rem;
transition: background-color var(--transition-fast);
}
.nav-links .login-btn:hover {
background-color: rgba(255, 255, 255, 0.3);
}
/* Make sure forum-header description stays darker blue */
.forum-header .forum-description {
color: #1e2c5f !important;
}
/* Article Meta Styles */
.article-meta {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1rem;
padding-bottom: 0.8rem;
border-bottom: 1px solid var(--gray-light);
font-size: 1.2rem;
color: var(--text-color-light);
}
.article-date,
.reading-time {
display: flex;
align-items: center;
gap: 0.5rem;
}
.article-date i,
.reading-time i {
color: var(--primary-color);
}
/* Read More Link Styles */
.read-more {
display: inline-block;
margin-top: 1rem;
padding: 0.8rem 1.5rem;
background-color: var(--primary-color);
color: var(--white);
text-decoration: none;
border-radius: 0.4rem;
font-weight: 500;
font-size: 1.4rem;
transition: background-color var(--transition-fast);
border: 2px solid var(--primary-color);
}
.read-more:hover {
background-color: var(--white);
color: var(--primary-color);
}
/* HetNieuws.app Style Article Components */
.article-meta {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1rem;
padding-bottom: 0.8rem;
border-bottom: 1px solid var(--gray-light);
font-size: 1.2rem;
color: var(--text-color-light);
}
.article-date,
.reading-time {
display: flex;
align-items: center;
gap: 0.5rem;
}
.article-date i,
.reading-time i {
color: var(--primary-color);
}
/* Read More Link Styles */
.read-more {
display: inline-block;
margin-top: 1rem;
padding: 0.8rem 1.5rem;
background-color: var(--primary-color);
color: var(--white);
text-decoration: none;
border-radius: 0.4rem;
font-weight: 500;
font-size: 1.4rem;
transition: background-color var(--transition-fast);
border: 2px solid var(--primary-color);
}
.read-more:hover {
background-color: var(--white);
color: var(--primary-color);
}
.dark-mode .read-more:hover {
background-color: var(--white);
color: var(--accent-color);
}
/* HetNieuws.app Style Article Components */
.article.featured-article {
border: 1px solid var(--gray-light);
border-radius: 8px;
margin-bottom: 2rem;
padding: 2rem;
background-color: var(--white);
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
position: relative;
transition: box-shadow var(--transition-fast);
}
.article.featured-article:hover {
box-shadow: 0 4px 16px rgba(0,0,0,0.15);
}
.article.featured-article:focus {
outline: 2px solid var(--primary-color);
outline-offset: 2px;
}
.featured-badge {
position: absolute;
top: -1rem;
left: 2rem;
background-color: var(--accent-color);
color: var(--white);
padding: 0.5rem 1rem;
border-radius: 20px;
font-size: 1.2rem;
font-weight: 600;
box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.article-categories {
margin-bottom: 1rem;
}
.article-category {
background-color: var(--primary-color);
color: var(--white);
border: none;
padding: 0.4rem 0.8rem;
border-radius: 4px;
font-size: 1.2rem;
font-weight: 500;
cursor: pointer;
transition: background-color var(--transition-fast);
}
.article-category:hover {
background-color: var(--primary-color-dark);
}
.article-title-link {
color: var(--primary-color);
text-decoration: none;
font-size: 1.8rem;
font-weight: 700;
line-height: 1.3;
margin-bottom: 1rem;
display: block;
transition: color var(--transition-fast);
}
.article-title-link:hover {
color: var(--primary-color-dark);
text-decoration: underline;
}
.article-actions {
display: flex;
flex-direction: column;
gap: 1rem;
margin-top: 1.5rem;
}
.article-tags {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
}
.article-tag {
background-color: var(--gray-light);
color: var(--text-color);
border: 1px solid var(--gray-medium);
padding: 0.3rem 0.6rem;
border-radius: 4px;
font-size: 1.2rem;
cursor: pointer;
transition: all var(--transition-fast);
}
.article-tag:hover {
background-color: var(--primary-color);
color: var(--white);
border-color: var(--primary-color);
}
.share-buttons {
display: flex;
flex-wrap: wrap;
gap: 0.5rem;
margin-top: 1rem;
}
.share-btn {
display: inline-flex;
align-items: center;
gap: 0.5rem;
padding: 0.6rem 1rem;
border-radius: 4px;
text-decoration: none;
font-size: 1.3rem;
font-weight: 500;
transition: all var(--transition-fast);
border: 1px solid transparent;
}
.share-btn:hover {
transform: translateY(-1px);
box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
.facebook-share {
background-color: #1877f2;
color: var(--white);
}
.facebook-share:hover {
background-color: #166fe5;
}
.twitter-share {
background-color: #1da1f2;
color: var(--white);
}
.twitter-share:hover {
background-color: #1a91da;
}
.whatsapp-share {
background-color: #25d366;
color: var(--white);
}
.whatsapp-share:hover {
background-color: #22c55e;
}
.linkedin-share {
background-color: #0077b5;
color: var(--white);
}
.linkedin-share:hover {
background-color: #005885;
}
.email-share {
background-color: var(--gray-light);
color: var(--text-color);
border-color: var(--gray-medium);
}
.email-share:hover {
background-color: var(--gray-medium);
}
/* Dark mode adjustments for new article styles */
.dark-mode .article.featured-article {
background-color: #1e1e1e;
border-color: #444;
}
.dark-mode .article.featured-article:hover {
box-shadow: 0 4px 16px rgba(0,0,0,0.3);
}
.dark-mode .article-title-link {
color: #e0e0e0;
}
.dark-mode .article-title-link:hover {
color: #fff;
}
.dark-mode .article-tag {
background-color: #333;
color: #e0e0e0;
border-color: #555;
}
.dark-mode .article-tag:hover {
background-color: var(--accent-color);
color: var(--white);
}
.dark-mode .email-share {
background-color: #333;
color: #e0e0e0;
border-color: #555;
}
.dark-mode .email-share:hover {
background-color: #444;
}
</style>
</head>
<body>
<!-- Skip to main content link for accessibility -->
<a href="#main-content" class="skip-to-content">Skip to main content</a>
<header class="site-header" role="banner">
<div class="logo-container">
<img src="/assets/logo-clean-600.png" alt="Politie-Forum.nl logo - Officieel Nederlands politie forum voor nieuws, discussies en veiligheidsinformatie" width="48" height="48" loading="eager">
<a href="/" title="Politie-Forum.nl - Home - Laatste politienieuws en veiligheidsforum Nederland">Politie-Forum.nl</a>
</div>
<nav class="nav-links" id="navLinks" role="navigation" aria-label="Hoofdnavigatie">
<a href="/" title="Naar de homepagina"><i class="fas fa-home" aria-hidden="true"></i> Home</a>
<a href="/search" title="Zoek in politieberichten"><i class="fas fa-search" aria-hidden="true"></i> Zoeken</a>
<a href="/categories" title="Bekijk alle categorieën"><i class="fas fa-list" aria-hidden="true"></i> Categorieën</a>
<a href="/forum" title="Bekijk het forum" class="active"><i class="fas fa-comments" aria-hidden="true"></i> Forum</a>
<a href="/opsporingen" title="Actuele opsporingen"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Opsporingen</a>
<a href="/contact" title="Neem contact met ons op"><i class="fas fa-envelope" aria-hidden="true"></i> Contact</a>
<a href="/admin" title="Admin Panel"><i class="fas fa-cog" aria-hidden="true"></i> Admin</a>
<button id="darkModeToggle" class="dark-mode-toggle" aria-label="Donkere modus schakelen">
<i class="fas fa-moon" aria-hidden="true" id="darkModeIcon"></i>
<span id="darkModeText">Licht</span>
</button>
</nav>
<button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Menu openen" aria-expanded="false">
<i class="fas fa-bars" aria-hidden="true"></i>
</button>
</header>
<!-- News flasher with breaking news headlines -->
<div class="news-flasher">
<div class="flasher-label">BREAKING NEWS:</div>
<div class="flasher-container">
<div class="flasher-content">
<!-- Content will be dynamically loaded from latest 5 articles -->
</div>
</div>
</div>
<main id="main-content" class="main-container">
<section class="content-area" role="main">
<nav aria-label="Breadcrumb" class="breadcrumbs">
<a href="/">Home</a>
<span class="separator" aria-hidden="true"><i class="fas fa-chevron-right"></i></span>
<span class="current">Forum</span>
</nav>
<div class="forum-container">
<div class="forum-header">
<h1>Politie-Forum.nl Forum</h1>
<p class="forum-description">Welkom op het forum van Politie-Forum.nl. Discussieer hier over politieberichten en veiligheidszaken in Nederland.</p>
</div>
<div class="forum-categories">
<!-- Dynamic forum categories will be loaded here -->
</div>
<div class="pagination">
<button class="pagination-btn"><i class="fas fa-chevron-left"></i> Vorige</button>
<button class="pagination-btn active">1</button>
<button class="pagination-btn">2</button>
<button class="pagination-btn">3</button>
<button class="pagination-btn">Volgende <i class="fas fa-chevron-right"></i></button>
</div>
</section>
<aside class="sidebar-content" role="complementary" aria-label="Sidebar">

<!-- User login/logout widget -->
<div class="user-widget">
<div class="user-content" id="userLoggedOut">
<h2 class="user-widget-title">Gebruiker</h2>
<button id="loginBtn" class="login-btn-lg">Inloggen</button>
</div>
<div class="user-content" id="userLoggedIn" style="display:none;">
<div class="user-avatar-lg" id="userAvatar">J</div>
<div class="user-name-lg" id="userName">JanDoe</div>
<button id="logoutBtn" class="logout-btn-lg">Uitloggen</button>
</div>
</div>

<!-- Search widget -->
<div class="widget">
<h2 class="widget-title">Zoeken</h2>
<form class="search-form" id="searchForm" role="search">
<label for="searchInput" class="visually-hidden">Zoeken in het forum</label>
<input type="text" id="searchInput" name="query" placeholder="Zoek in het forum..." aria-label="Zoeken">
<button type="submit">Zoeken</button>
</form>
</div>
<!-- Emergency widget with important contact numbers -->
<div class="emergency-widget">
<h2><i class="fas fa-phone-alt"></i> Noodnummers</h2>
<ul class="emergency-numbers">
<li><i class="fas fa-ambulance"></i>Spoed: <a href="tel:112">112</a></li>
<li><i class="fas fa-shield-alt"></i> Politie: <a href="tel:0900-8844">0900-8844</a></li>
<li><i class="fas fa-child"></i> Mishandeling: <a href="tel:0800-2000">0800-2000</a></li>
</ul>
</div>
<nav class="categories-widget">
<h2 class="widget-title">Forum Categorieën</h2>
<ul class="categories-list">
<li class="category-item">
<a href="/forum" data-category="all"><i class="fas fa-home"></i> Alle Categorieën</a>
</li>
<li class="category-item">
<a href="/forum/recente-incidenten" data-category="recente-incidenten"><i class="fas fa-newspaper"></i> Recente incidenten</a>
</li>
<li class="category-item">
<a href="/forum/juridische-kwesties" data-category="juridische-kwesties"><i class="fas fa-balance-scale"></i> Juridische kwesties</a>
</li>
<li class="category-item">
<a href="/forum/woningbeveiliging" data-category="woningbeveiliging"><i class="fas fa-shield-alt"></i> Woningbeveiliging</a>
</li>
<li class="category-item">
<a href="/forum/buurtpreventie" data-category="buurtpreventie"><i class="fas fa-street-view"></i> Buurtpreventie</a>
</li>
<li class="category-item">
<a href="/forum/noord-nederland" data-category="noord-nederland"><i class="fas fa-map-marker-alt"></i> Noord-Nederland</a>
</li>
<li class="category-item">
<a href="/forum/randstad" data-category="randstad"><i class="fas fa-map-marker-alt"></i> Randstad</a>
</li>
<li class="category-item">
<a href="/forum/zuid-nederland" data-category="zuid-nederland"><i class="fas fa-map-marker-alt"></i> Zuid-Nederland</a>
</li>
</ul>
</nav>
<section class="widget">
<h2 class="widget-title">Recente Topics</h2>
<ul id="recent-posts-list" class="recent-posts-list" aria-label="Recente forumberichten">
<!-- Recent posts will be dynamically loaded -->
</ul>
</section>
<section class="widget">
<h2 class="widget-title">Populaire Tags</h2>
<div class="tags-widget" id="popularTags" aria-label="Populaire tags">
<!-- Tags will be dynamically loaded -->
</div>
</section>
<section class="widget">
<h2 class="widget-title">Forum Notificaties</h2>
<p>Ontvang direct bericht bij nieuwe posts in jouw favoriete topics of categorieën.</p>
<form class="newsletter-form" id="newsletterForm">
<label for="notification-email" class="visually-hidden">E-mailadres voor forum notificaties</label>
<input type="email" id="notification-email" name="email" placeholder="Jouw e-mailadres" required aria-required="true">
<button type="submit">Aanmelden</button>
</form>
</section>
<section class="widget">
<h2 class="widget-title">Volg Ons</h2>
<div class="footer-social">
<a href="#" title="Volg ons op Facebook" aria-label="Facebook" rel="nofollow"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op Twitter" aria-label="Twitter" rel="nofollow"><i class="fab fa-twitter" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op Instagram" aria-label="Instagram" rel="nofollow"><i class="fab fa-instagram" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op LinkedIn" aria-label="LinkedIn" rel="nofollow"><i class="fab fa-linkedin-in" aria-hidden="true"></i></a>
</div>
</section>
</aside>
</main>
<!-- Login/Register Modal -->
<div id="authModal" class="modal">
<div class="modal-content">
<span class="close-btn" id="closeModal">&times;</span>
<div class="modal-header">
<h3 class="modal-title">Inloggen</h3>
</div>
<div class="form-tabs">
<div class="form-tab active" data-tab="login">Inloggen</div>
<div class="form-tab" data-tab="register">Registreren</div>
</div>
<div id="authError" class="auth-error"></div>
<!-- Login Form -->
<form id="loginForm" style="display: block;">
<div class="form-group">
<label for="loginEmail">E-mailadres</label>
<input type="email" id="loginEmail" name="email" class="form-control" required>
</div>
<div class="form-group">
<label for="loginPassword">Wachtwoord</label>
<input type="password" id="loginPassword" name="password" class="form-control" required>
</div>
<div class="forgot-password">
<a href="#">Wachtwoord vergeten?</a>
</div>
<button type="submit" class="auth-btn">Inloggen</button>
<div class="form-footer">
Nog geen account? <a href="#" id="showRegisterForm">Registreer hier</a>
</div>
</form>
<!-- Register Form -->
<form id="registerForm" style="display: none;">
<div class="form-group">
<label for="registerName">Naam</label>
<input type="text" id="registerName" name="name" class="form-control" required>
</div>
<div class="form-group">
<label for="registerEmail">E-mailadres</label>
<input type="email" id="registerEmail" name="email" class="form-control" required>
</div>
<div class="form-group">
<label for="registerPassword">Wachtwoord</label>
<input type="password" id="registerPassword" name="password" class="form-control" required>
</div>
<div class="form-group">
<label for="registerConfirmPassword">Bevestig wachtwoord</label>
<input type="password" id="registerConfirmPassword" name="confirmPassword" class="form-control" required>
</div>
<div class="form-group">
<input type="checkbox" id="terms" name="terms" required>
<label for="terms">Ik ga akkoord met de <a href="/terms-of-service" target="_blank">gebruiksvoorwaarden</a> en <a href="/privacy-policy" target="_blank">privacybeleid</a></label>
</div>
<button type="submit" class="auth-btn">Registreren</button>
<div class="form-footer">
Al een account? <a href="#" id="showLoginForm">Log hier in</a>
</div>
</form>
</div>
</div>
<footer class="footer" role="contentinfo">
<div class="footer-container">
<div class="footer-section">
<h2>Over Politie-Forum.nl</h2>
<p>Politie-Forum.nl biedt het laatste politienieuws uit Nederland. Wij bundelen berichten van politiekorpsen door het hele land om u te informeren over veiligheid, misdaad en opsporingsactiviteiten in uw buurt.</p>
<div class="footer-social">
<a href="#" title="Volg ons op Facebook" aria-label="Facebook" rel="nofollow"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op Twitter" aria-label="Twitter" rel="nofollow"><i class="fab fa-twitter" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op Instagram" aria-label="Instagram" rel="nofollow"><i class="fab fa-instagram" aria-hidden="true"></i></a>
<a href="#" title="Volg ons op LinkedIn" aria-label="LinkedIn" rel="nofollow"><i class="fab fa-linkedin-in" aria-hidden="true"></i></a>
</div>
</div>
<div class="footer-section">
<h2>Navigatie</h2>
<ul class="footer-links">
<li><a href="/" title="Naar de homepagina">Home</a></li>
<li><a href="/categories" title="Bekijk alle categorieën">Categorieën</a></li>
<li><a href="/forum" title="Bekijk het forum">Forum</a></li>
<li><a href="/opsporingen" title="Actuele opsporingen">Opsporingen</a></li>
<li><a href="/vermissingen" title="Vermiste personen">Vermissingen</a></li>
<li><a href="/tips" title="Tips over veiligheid">Veiligheidstips</a></li>
<li><a href="/contact" title="Neem contact met ons op">Contact</a></li>
<li><a href="/admin" title="Admin Panel">Admin</a></li>
</ul>
</div>
<div class="footer-section">
<h2>Juridisch</h2>
<ul class="footer-links">
<li><a href="/privacy-policy" title="Lees ons privacybeleid">Privacybeleid</a></li>
<li><a href="/cookie-policy" title="Lees ons cookiebeleid">Cookiebeleid</a></li>
<li><a href="/terms-of-service" title="Lees onze gebruiksvoorwaarden">Gebruiksvoorwaarden</a></li>
<li><a href="/forum-rules" title="Lees onze forumregels">Forumregels</a></li>
<li><a href="/disclaimer" title="Lees onze disclaimer">Disclaimer</a></li>
<li><a href="/accessibility" title="Toegankelijkheidsverklaring">Toegankelijkheid</a></li>
</ul>
</div>
</div>
<div class="footer-bottom">
<p>&copy; 2025 Politie-Forum.nl - Alle rechten voorbehouden | 
<a href="https://politie-forum.web.app" rel="noopener" title="Officiële website">Geen officiële website van de Nederlandse Politie</a> | 
<a href="https://www.politie.nl" rel="noopener" title="Officiële Politie Website">Bezoek de officiële website</a>
</p>
</div>
</footer>
<button class="scroll-top" id="scrollTop" aria-label="Scroll naar boven">
<i class="fas fa-arrow-up" aria-hidden="true"></i>
</button>
<script type="module">
// Import the necessary Firebase modules
import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js';
import { getDatabase, ref, get, onValue, query, orderByChild, limitToLast, push, set } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js';
import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js';
import { getAnalytics, logEvent } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js';
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js';

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDCRYKrWUvtOtDAY4TThjlm7AxkzHG-62s",
  authDomain: "politie-forum.web.app",
  databaseURL: "https://blockchainkix-com-fy-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "blockchainkix-com-fy",
  storageBucket: "blockchainkix-com-fy.firebasestorage.app",
  messagingSenderId: "148890561425",
  appId: "1:148890561425:web:7cba0e7477141e3a880830"
};

// Add error handling for Firebase initialization
try {
  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const firestore = getFirestore(app);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  
  console.log("Firebase initialized successfully");
  
  // Log page view event
  logEvent(analytics, 'page_view', {
    page_title: document.title,
    page_location: window.location.href,
    page_path: window.location.pathname
  });

  // Make Firebase objects globally available for debugging
  window.firebaseApp = app;
  window.firebaseDb = db;
  window.firebaseFirestore = firestore;
  window.firebaseAuth = auth;
  
  // Test function to check Firestore connectivity
  window.testFirestoreConnection = async function() {
    try {
      console.log("Testing Firestore connection...");
      const articlesRef = collection(firestore, 'articles_rewritten');
      const querySnapshot = await getDocs(articlesRef);
      console.log(`Found ${querySnapshot.size} articles in Firestore`);
      querySnapshot.forEach((doc) => {
        console.log("Article:", doc.id, doc.data());
      });
      return querySnapshot.size;
    } catch (error) {
      console.error("Firestore test failed:", error);
      return 0;
    }
  };
  
  // Manual function to load articles (for testing)
  window.loadArticles = async function() {
    console.log('🔄 Manual article load triggered');
    try {
      const articlesRef = collection(firestore, 'articles_rewritten');
      console.log('🔍 Attempting to fetch articles from Firestore...');
      
      const snapshot = await getDocs(articlesRef);
      console.log(`✅ Successfully fetched ${snapshot.docs.length} rewritten articles from Firestore`);
      
      // Find the actueel category body
      const actueelCategory = document.querySelector('.category:has(.category-header h2:contains("Actueel Politie Nieuws")) .category-body');
      if (actueelCategory) {
        // Clear existing content except the test button
        const testButton = actueelCategory.querySelector('button[onclick*="loadArticles"]');
        actueelCategory.innerHTML = '';
        if (testButton) {
          actueelCategory.appendChild(testButton);
        }
        
        if (snapshot.docs.length === 0) {
          const noArticlesElement = document.createElement('div');
          noArticlesElement.className = 'article featured-article';
          noArticlesElement.innerHTML = `
            <div class="featured-badge">Info</div>
            <div class="article-content">
              <div class="article-categories">
                <button class="article-category" type="button">Systeem</button>
              </div>
              <h3 id="article-title-info">Geen artikelen gevonden</h3>
              <div class="article-meta">
                <div class="article-date">
                  <i class="far fa-calendar-alt" aria-hidden="true"></i> ${new Date().toLocaleDateString('nl-NL')} om ${new Date().toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit' })}
                </div>
                <div class="reading-time">
                  <i class="far fa-clock" aria-hidden="true"></i> 1 min leestijd
                </div>
              </div>
              <p>Er zijn nog geen artikelen beschikbaar. Gebruik de news-ripper om artikelen toe te voegen.</p>
              <div class="article-actions">
                <button class="read-more" onclick="location.reload()">Vernieuwen</button>
                <div class="article-tags">
                  <button class="article-tag" type="button">Info</button>
                  <button class="article-tag" type="button">Systeem</button>
                </div>
              </div>
            </div>
          `;
          actueelCategory.appendChild(noArticlesElement);
        } else {
          snapshot.docs.forEach((doc, index) => {
            const article = doc.data();
            console.log(`📄 Processing article: ${article.title || 'No title'}`);
            const articleElement = document.createElement('div');
            articleElement.className = 'article featured-article';
            
            // Generate article URL for internal site
            const articleSlug = article.title ? article.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '') : 'artikel';
            const articleUrl = `https://politie-forum.nl/article/${articleSlug}`;
            
            // Generate 3-sentence preview
            let articlePreview = '';
            if (article.full_text) {
              // Split by sentences and take first 3
              const sentences = article.full_text.match(/[^\.!?]+[\.!?]+/g) || [];
              articlePreview = sentences.slice(0, 3).join(' ').trim();
              if (sentences.length > 3) {
                articlePreview += '...';
              }
            }
            if (!articlePreview) {
              articlePreview = article.preview || article.summary || 'Lees het volledige artikel...';
            }
            
            // Format date with robust timestamp handling
            let articleDate;
            try {
              if (article.timestamp) {
                // Handle Firestore Timestamp format
                if (article.timestamp.seconds) {
                  articleDate = new Date(article.timestamp.seconds * 1000);
                }
                // Handle regular timestamp
                else if (typeof article.timestamp === 'number') {
                  articleDate = new Date(article.timestamp);
                }
                // Handle string dates
                else if (typeof article.timestamp === 'string') {
                  articleDate = new Date(article.timestamp);
                }
                // Handle Date objects
                else {
                  articleDate = new Date(article.timestamp);
                }
                
                // Validate the date
                if (isNaN(articleDate.getTime())) {
                  console.warn('Invalid timestamp for article:', article.title, 'using current date');
                  articleDate = new Date();
                }
              } else {
                articleDate = new Date();
              }
            } catch (error) {
              console.error('Error parsing timestamp for article:', article.title, error);
              articleDate = new Date();
            }
            
            const formattedDate = articleDate.toLocaleDateString('nl-NL', { 
              day: 'numeric', 
              month: 'long', 
              year: 'numeric' 
            }) + ' om ' + articleDate.toLocaleTimeString('nl-NL', { 
              hour: '2-digit', 
              minute: '2-digit' 
            });
            
            const readingTime = Math.max(1, Math.ceil((article.full_text || '').split(' ').length / 200));
            const articleTags = article.tags || ['Politie', 'Nieuws', 'Nederland'];
            
            articleElement.innerHTML = `
              <div class="featured-badge">Uitgelicht</div>
              <div class="article-content">
                <div class="article-categories">
                  <button class="article-category" type="button">${article.category || 'Politie'}</button>
                </div>
                <h3 id="article-title-${index}"><a href="${articleUrl}" class="article-title-link" target="_blank" rel="noopener noreferrer">${article.title || 'Nieuwsartikel'}</a></h3>
                <div class="article-meta">
                  <div class="article-date">
                    <i class="far fa-calendar-alt" aria-hidden="true"></i> ${formattedDate}
                  </div>
                  <div class="reading-time">
                    <i class="far fa-clock" aria-hidden="true"></i> ${readingTime} min leestijd
                  </div>
                </div>
                <p>${articlePreview}</p>
                <div class="article-actions">
                  <a href="${articleUrl}" class="read-more">Lees meer</a>
                  <div class="article-tags">
                    ${articleTags.map(tag => `<button class="article-tag" type="button">${tag}</button>`).join('')}
                  </div>
                </div>
              </div>
            `;
            actueelCategory.appendChild(articleElement);
          });
        }
      }
    } catch (error) {
      console.error('❌ Error in manual article load:', error);
    }
  };
  
  console.log("Firebase test function available: window.testFirestoreConnection()");

  // State variables for forum
  let forumCategories = [];
  let forumSections = [];
  let forumTopics = [];
  let allPosts = [];
  
  // Store current filters
  let currentLocation = 'all';
  let currentCategory = 'all';
  let currentTag = null;
  
  // DOM elements
  const categoryHeaders = document.querySelectorAll('.category-header');
  const authModal = document.getElementById('authModal');
  const loginBtn = document.getElementById('loginBtn');
  const closeModalBtn = document.getElementById('closeModal');
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  const showRegisterFormBtn = document.getElementById('showRegisterForm');
  const showLoginFormBtn = document.getElementById('showLoginForm');
  const userLoggedIn = document.getElementById('userLoggedIn');
  const userLoggedOut = document.getElementById('userLoggedOut');
  const userAvatar = document.getElementById('userAvatar');
  const userName = document.getElementById('userName');
  const logoutBtn = document.getElementById('logoutBtn');
  const authError = document.getElementById('authError');
  const mobileMenuToggle = document.getElementById('mobileMenuToggle');
  const navLinks = document.getElementById('navLinks');
  const formTabs = document.querySelectorAll('.form-tab');
  const scrollTop = document.getElementById('scrollTop');
  const flasherContent = document.querySelector('.flasher-content');
  const popularTags = document.getElementById('popularTags');
  const recentPostsList = document.getElementById('recent-posts-list');
  const forumCategoriesContainer = document.querySelector('.forum-categories');
  
  // Mobile menu toggle
  if (mobileMenuToggle) {
    mobileMenuToggle.addEventListener('click', function() {
      navLinks.classList.toggle('show');
      // Update ARIA expanded state
      const isExpanded = navLinks.classList.contains('show');
      mobileMenuToggle.setAttribute('aria-expanded', isExpanded);
    });
  }
  
  // Scroll to top button
  window.addEventListener('scroll', function() {
    if (window.pageYOffset > 300) {
      scrollTop.classList.add('visible');
    } else {
      scrollTop.classList.remove('visible');
    }
  });
  
  if (scrollTop) {
    scrollTop.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }
  
  // Tab switching in auth modal
  formTabs.forEach(tab => {
    tab.addEventListener('click', function() {
      // Remove active class from all tabs
      formTabs.forEach(t => t.classList.remove('active'));
      // Add active class to clicked tab
      this.classList.add('active');
      
      // Hide all forms
      loginForm.style.display = 'none';
      registerForm.style.display = 'none';
      
      // Show selected form
      if (this.dataset.tab === 'login') {
        loginForm.style.display = 'block';
        document.querySelector('.modal-title').textContent = 'Inloggen';
      } else {
        registerForm.style.display = 'block';
        document.querySelector('.modal-title').textContent = 'Registreren';
      }
    });
  });
  
  // Show register form when clicking the link in login form
  showRegisterFormBtn.addEventListener('click', function(e) {
    e.preventDefault();
    loginForm.style.display = 'none';
    registerForm.style.display = 'block';
    document.querySelector('.modal-title').textContent = 'Registreren';
    
    formTabs.forEach(tab => {
      tab.classList.remove('active');
      if (tab.dataset.tab === 'register') {
        tab.classList.add('active');
      }
    });
  });
  
  // Show login form when clicking the link in register form
  showLoginFormBtn.addEventListener('click', function(e) {
    e.preventDefault();
    registerForm.style.display = 'none';
    loginForm.style.display = 'block';
    document.querySelector('.modal-title').textContent = 'Inloggen';
    
    formTabs.forEach(tab => {
      tab.classList.remove('active');
      if (tab.dataset.tab === 'login') {
        tab.classList.add('active');
      }
    });
  });
  
  // Open auth modal
  loginBtn.addEventListener('click', function() {
    authModal.style.display = 'block';
  });
  
  // Close auth modal
  closeModalBtn.addEventListener('click', function() {
    authModal.style.display = 'none';
    // Reset auth forms
    loginForm.reset();
    registerForm.reset();
    authError.style.display = 'none';
  });
  
  // Close modal when clicking outside
  window.addEventListener('click', function(event) {
    if (event.target === authModal) {
      authModal.style.display = 'none';
      // Reset auth forms
      loginForm.reset();
      registerForm.reset();
      authError.style.display = 'none';
    }
  });
  
  // Handle login form submission
  loginForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Bezig...';
    
    // Clear previous errors
    authError.style.display = 'none';
    
    // Sign in with Firebase Auth
    signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // User signed in successfully
        console.log('User logged in successfully:', userCredential.user.email);
        
        // Close the modal
        authModal.style.display = 'none';
        
        // Reset the form
        loginForm.reset();
        
        // Update UI
        updateUserUI(userCredential.user);
        
        // Log event
        logEvent(analytics, 'login', {
          method: 'email'
        });
      })
      .catch((error) => {
        // Handle errors
        console.error('Login error:', error);
        
        // Display error message
        authError.style.display = 'block';
        
        // Translate common error messages to Dutch
        switch (error.code) {
          case 'auth/user-not-found':
            authError.textContent = 'Er is geen gebruiker gevonden met dit e-mailadres.';
            break;
          case 'auth/wrong-password':
            authError.textContent = 'Onjuist wachtwoord, probeer opnieuw.';
            break;
          case 'auth/too-many-requests':
            authError.textContent = 'Te veel inlogpogingen. Probeer het later opnieuw.';
            break;
          default:
            authError.textContent = 'Er is een fout opgetreden bij het inloggen: ' + error.message;
        }
      })
      .finally(() => {
        // Reset button state
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      });
  });
  
  // Handle register form submission
  registerForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    const confirmPassword = document.getElementById('registerConfirmPassword').value;
    
    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Bezig...';
    
    // Clear previous errors
    authError.style.display = 'none';
    
    // Validate password match
    if (password !== confirmPassword) {
      authError.style.display = 'block';
      authError.textContent = 'Wachtwoorden komen niet overeen.';
      submitBtn.disabled = false;
      submitBtn.textContent = originalText;
      return;
    }
    
    // Create user with Firebase Auth
    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Update profile with display name
        return updateProfile(userCredential.user, {
          displayName: name
        }).then(() => {
          return userCredential;
        });
      })
      .then((userCredential) => {
        // User created and profile updated successfully
        console.log('User registered successfully:', userCredential.user.email);
        
        // Save user data to database
        const userId = userCredential.user.uid;
        const userData = {
          name: name,
          email: email,
          createdAt: new Date().toISOString(),
          role: 'user'
        };
        
        return set(ref(db, 'users/' + userId), userData)
          .then(() => userCredential);
      })
      .then((userCredential) => {
        // Close the modal
        authModal.style.display = 'none';
        
        // Reset the form
        registerForm.reset();
        
        // Update UI
        updateUserUI(userCredential.user);
        
        // Log event
        logEvent(analytics, 'sign_up', {
          method: 'email'
        });
      })
      .catch((error) => {
        // Handle errors
        console.error('Registration error:', error);
        
        // Display error message
        authError.style.display = 'block';
        
        // Translate common error messages to Dutch
        switch (error.code) {
          case 'auth/email-already-in-use':
            authError.textContent = 'Dit e-mailadres is al in gebruik.';
            break;
          case 'auth/weak-password':
            authError.textContent = 'Het wachtwoord moet minstens 6 tekens lang zijn.';
            break;
          default:
            authError.textContent = 'Er is een fout opgetreden bij het registreren: ' + error.message;
        }
      })
      .finally(() => {
        // Reset button state
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      });
  });
  
  // Handle logout
  logoutBtn.addEventListener('click', function() {
    signOut(auth).then(() => {
      // Sign-out successful
      console.log('User signed out');
      
      // Update UI
      userLoggedIn.style.display = 'none';
      userLoggedOut.style.display = 'block';
      
      // Log event
      logEvent(analytics, 'logout');
    }).catch((error) => {
      console.error('Error signing out:', error);
    });
  });
  
  // Listen for auth state changes
  onAuthStateChanged(auth, (user) => {
    if (user) {
      // User is signed in
      updateUserUI(user);
    } else {
      // User is signed out
      userLoggedIn.style.display = 'none';
      userLoggedOut.style.display = 'block';
    }
  });
  
  // Update UI based on user state
  function updateUserUI(user) {
    if (user) {
      // Set user avatar text (first letter of display name)
      const displayName = user.displayName || 'User';
      userAvatar.textContent = displayName.charAt(0).toUpperCase();
      
      // Set user name
      userName.textContent = displayName;
      
      // Show logged in UI, hide logged out UI
      userLoggedIn.style.display = 'block';
      userLoggedOut.style.display = 'none';
    }
  }
  
  // Newsletter form handling
  const newsletterForm = document.getElementById('newsletterForm');
  if (newsletterForm) {
    newsletterForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const email = this.querySelector('input[type="email"]').value;
      
      // In a real implementation, you would send this to your backend or Firebase
      console.log('Newsletter subscription:', email);
      
      // Add to database if possible
      try {
        const newSubscriptionRef = push(ref(db, 'newsletter-subscribers'));
        set(newSubscriptionRef, {
          email: email,
          timestamp: new Date().toISOString(),
          source: 'forum'
        }).then(() => {
          alert(`Bedankt voor je aanmelding voor forum notificaties met: ${email}`);
          this.reset();
          
          // Log event
          logEvent(analytics, 'sign_up', {
            method: 'newsletter'
          });
        }).catch(error => {
          console.error('Error saving subscription:', error);
          alert('Er is een fout opgetreden bij het aanmelden. Probeer het later opnieuw.');
        });
      } catch (error) {
        console.error('Error creating subscription:', error);
        alert(`Bedankt voor je aanmelding voor forum notificaties met: ${email}`);
        this.reset();
      }
    });
  }
  
  // Load and update the news flasher with latest 5 articles
  async function updateNewsFlasher() {
    try {
      // If flasher content doesn't exist, return
      if (!flasherContent) return;
      
      console.log("Updating news flasher with latest 5 articles");
      
      // Get latest 5 articles from articles collection
      const articlesRef = ref(db, 'articles');
      // Create a query to get the latest 5 articles
      const articlesQuery = query(articlesRef, orderByChild('timestamp'), limitToLast(5));
      
      const articlesSnapshot = await get(articlesQuery);
      let latestArticles = [];
      
      if (articlesSnapshot.exists()) {
        // Get articles from Firebase
        const articlesData = articlesSnapshot.val();
        
        // Convert to array and sort by timestamp (newest first)
        latestArticles = Object.values(articlesData)
          .sort((a, b) => b.timestamp - a.timestamp)
          .slice(0, 5)
          .map(article => article.title);
        
        console.log("Found latest articles:", latestArticles);
      } else {
        console.log("No articles found in database, using defaults");
        // Use default articles if none found in database
        latestArticles = [
          'Twee verdachten aangehouden na gewapende overval in Amsterdam-Zuid',
          'Politie waarschuwt voor nieuwe oplichtingstruc via WhatsApp',
          'Vermist meisje (8) gezocht in Amsterdam-Noord',
          'Grote drugsvangst in Rotterdamse haven', 
          'Inbraakgolf in Eindhoven: politie zoekt getuigen'
        ];
      }
      
      // Clear existing content
      flasherContent.innerHTML = '';
      
      // Add each article
      latestArticles.forEach((title, index) => {
        const newsSpan = document.createElement('span');
        newsSpan.textContent = title;
        newsSpan.style.cursor = 'pointer';
        flasherContent.appendChild(newsSpan);
        
        // Add separator except after the last item
        if (index < latestArticles.length - 1) {
          const separator = document.createElement('span');
          separator.className = 'flasher-separator';
          separator.textContent = '•';
          flasherContent.appendChild(separator);
        }
      });
      
      // Clone content for seamless looping
      const contentClone = flasherContent.innerHTML;
      flasherContent.innerHTML += contentClone;
      
    } catch (error) {
      console.error('Error updating news flasher:', error);
      
      // If error, use default news items
      const defaultNews = [
        'Twee verdachten aangehouden na gewapende overval in Amsterdam-Zuid',
        'Politie waarschuwt voor nieuwe oplichtingstruc via WhatsApp',
        'Vermist meisje (8) gezocht in Amsterdam-Noord',
        'Grote drugsvangst in Rotterdamse haven', 
        'Inbraakgolf in Eindhoven: politie zoekt getuigen'
      ];
      
      // Clear existing content
      flasherContent.innerHTML = '';
      
      // Add each default news item
      defaultNews.forEach((title, index) => {
        const newsSpan = document.createElement('span');
        newsSpan.textContent = title;
        newsSpan.style.cursor = 'pointer';
        flasherContent.appendChild(newsSpan);
        
        // Add separator except after the last item
        if (index < defaultNews.length - 1) {
          const separator = document.createElement('span');
          separator.className = 'flasher-separator';
          separator.textContent = '•';
          flasherContent.appendChild(separator);
        }
      });
      
      // Clone content for seamless looping
      const contentClone = flasherContent.innerHTML;
      flasherContent.innerHTML += contentClone;
    }
  }
  
  // Load and display the dynamic forum data
  async function loadForumData() {
    try {
      console.log("Loading forum data...");
      
      // Load forum categories
      const categoriesRef = ref(db, 'forum/categories');
      const categoriesSnapshot = await get(categoriesRef);
      
      if (categoriesSnapshot.exists()) {
        forumCategories = Object.values(categoriesSnapshot.val());
        console.log("Loaded categories from database:", forumCategories.length);
      } else {
        // If no categories in database, use default ones
        console.log("No categories in database, using defaults");
        forumCategories = [
          { id: 'algemeen', name: 'Algemene categorieën', order: 1 },
          { id: 'actueel', name: 'Actueel Politie Nieuws', order: 2 },
          { id: 'regionaal', name: 'Regionaal', order: 3 },
          { id: 'preventie', name: 'Preventie en veiligheid', order: 4 }
        ];
      }
      
      // Load forum sections
      const sectionsRef = ref(db, 'forum/sections');
      const sectionsSnapshot = await get(sectionsRef);
      
      if (sectionsSnapshot.exists()) {
        forumSections = Object.values(sectionsSnapshot.val());
        console.log("Loaded sections from database:", forumSections.length);
      } else {
        // If no sections in database, use default ones
        console.log("No sections in database, using defaults");
        forumSections = [
          {
            id: 'aankondigingen',
            categoryId: 'algemeen',
            title: 'Aankondigingen',
            description: 'Belangrijke mededelingen over het forum en de website.',
            icon: 'fas fa-bullhorn',
            postCount: 42,
            topicCount: 12,
            latestPost: {
              title: 'Welkom bij het nieuwe forum',
              time: 'Vandaag, 09:45'
            },
            location: 'Landelijk',
            tags: ['aankondigingen', 'forum', 'website']
          },
          {
            id: 'welkom',
            categoryId: 'algemeen',
            title: 'Welkom & Introductie',
            description: 'Nieuw op het forum? Stel jezelf hier voor aan de community.',
            icon: 'fas fa-handshake',
            postCount: 156,
            topicCount: 58,
            latestPost: {
              title: 'Nieuw lid uit Rotterdam',
              time: 'Gisteren, 17:21'
            },
            location: 'Landelijk',
            tags: ['welkom', 'introductie', 'nieuw']
          },
          {
            id: 'recente-incidenten',
            categoryId: 'actueel',
            title: 'Recente incidenten',
            description: 'Discussieer over recente politieberichten en incidenten in Nederland.',
            icon: 'fas fa-newspaper',
            postCount: 842,
            topicCount: 254,
            latestPost: {
              title: 'Steekincident in Groningen',
              time: 'Vandaag, 12:32'
            },
            location: 'Landelijk',
            tags: ['incident', 'politiebericht', 'actueel']
          },
          {
            id: 'juridische-kwesties',
            categoryId: 'actueel',
            title: 'Juridische kwesties',
            description: 'Vragen en discussies over wetgeving en juridische zaken.',
            icon: 'fas fa-balance-scale',
            postCount: 524,
            topicCount: 175,
            latestPost: {
              title: 'Nieuwe wetgeving mbt cameratoezicht',
              time: '3 dagen geleden'
            },
            location: 'Landelijk',
            tags: ['juridisch', 'wetgeving', 'advies']
          },
          {
            id: 'noord-nederland',
            categoryId: 'regionaal',
            title: 'Noord-Nederland',
            description: 'Discussies over Groningen, Friesland en Drenthe.',
            icon: 'fas fa-map-marker-alt',
            postCount: 463,
            topicCount: 178,
            latestPost: {
              title: 'Inbraakgolf Leeuwarden',
              time: 'Vandaag, 08:14'
            },
            location: 'Noord-Nederland',
            tags: ['groningen', 'friesland', 'drenthe']
          },
          {
            id: 'randstad',
            categoryId: 'regionaal',
            title: 'Randstad',
            description: 'Discussies over Amsterdam, Rotterdam, Den Haag en Utrecht.',
            icon: 'fas fa-map-marker-alt',
            postCount: 891,
            topicCount: 302,
            latestPost: {
              title: 'Fietsdiefstal Centraal Station Amsterdam',
              time: 'Gisteren, 21:36'
            },
            location: 'Randstad',
            tags: ['amsterdam', 'rotterdam', 'denhaag', 'utrecht']
          },
          {
            id: 'zuid-nederland',
            categoryId: 'regionaal',
            title: 'Zuid-Nederland',
            description: 'Discussies over Noord-Brabant, Limburg en Zeeland.',
            icon: 'fas fa-map-marker-alt',
            postCount: 615,
            topicCount: 234,
            latestPost: {
              title: 'Drugsvondst Eindhoven',
              time: '2 dagen geleden'
            },
            location: 'Zuid-Nederland',
            tags: ['brabant', 'limburg', 'zeeland']
          },
          {
            id: 'woningbeveiliging',
            categoryId: 'preventie',
            title: 'Woningbeveiliging',
            description: 'Tips en adviezen over het beveiligen van je woning tegen inbraak.',
            icon: 'fas fa-shield-alt',
            postCount: 389,
            topicCount: 125,
            latestPost: {
              title: 'Slimme deurbellen: ervaringen',
              time: '3 dagen geleden'
            },
            location: 'Landelijk',
            tags: ['beveiliging', 'inbraak', 'preventie']
          },
          {
            id: 'buurtpreventie',
            categoryId: 'preventie',
            title: 'Buurtpreventie',
            description: 'Discussies over buurtpreventie, WhatsApp-groepen en burgerwachten.',
            icon: 'fas fa-street-view',
            postCount: 472,
            topicCount: 158,
            latestPost: {
              title: 'Opzetten buurtpreventie in kleine dorpen',
              time: 'Gisteren, 14:05'
            },
            location: 'Landelijk',
            tags: ['buurtpreventie', 'whatsapp', 'burgerwacht']
          }
        ];
      }
      
      // Sort categories by order
      forumCategories.sort((a, b) => a.order - b.order);
      
      // Render forum content
      renderForumContent();
      
      // Extract and render tags
      extractAndRenderTags();
      
      // Update recent posts list
      updateRecentPosts();
      
      // Listen for location filter changes
      document.querySelectorAll('[data-location]').forEach(element => {
        element.addEventListener('click', function(e) {
          e.preventDefault();
          currentLocation = this.getAttribute('data-location');
          filterForumSections();
          
          // Log event
          logEvent(analytics, 'select_content', {
            content_type: 'location',
            content_id: currentLocation
          });
        });
      });
      
      // Listen for category filter changes
      document.querySelectorAll('[data-category]').forEach(element => {
        element.addEventListener('click', function(e) {
          e.preventDefault();
          currentCategory = this.getAttribute('data-category');
          filterForumSections();
          
          // Log event
          logEvent(analytics, 'select_content', {
            content_type: 'category',
            content_id: currentCategory
          });
        });
      });
      
      // Listen for tag filter changes
      setupTagListeners();
      
    } catch (error) {
      console.error('Error loading forum data:', error);
      
      // Log error
      logEvent(analytics, 'exception', {
        description: 'Error loading forum data',
        fatal: false
      });
    }
  }
  
  // Update recent posts list
  function updateRecentPosts() {
    if (!recentPostsList) return;
    
    // Get the 5 most recent posts
    const recentTopics = forumSections
      .map(section => ({
        title: section.latestPost.title,
        time: section.latestPost.time,
        section: section.title,
        id: section.id
      }))
      .sort((a, b) => {
        // Sort by time (attempt to parse times like "Vandaag", "Gisteren", etc.)
        if (a.time.includes('Vandaag') && !b.time.includes('Vandaag')) return -1;
        if (!a.time.includes('Vandaag') && b.time.includes('Vandaag')) return 1;
        if (a.time.includes('Gisteren') && !b.time.includes('Gisteren') && !b.time.includes('Vandaag')) return -1;
        if (!a.time.includes('Gisteren') && b.time.includes('Gisteren') && !a.time.includes('Vandaag')) return 1;
        return 0;
      })
      .slice(0, 5);
    
    // Clear existing items
    recentPostsList.innerHTML = '';
    
    // Add recent posts
    recentTopics.forEach((topic, index) => {
      const li = document.createElement('li');
      li.className = 'recent-post';
      
      li.innerHTML = `
        <div class="recent-post-content">
          <h3><a href="/forum/${topic.id}/${topic.title.toLowerCase().replace(/\s+/g, '-')}" id="recent-post-${index}">${topic.title}</a></h3>
        </div>
      `;
      
      recentPostsList.appendChild(li);
    });
  }
  
  // Extract tags from sections and render in tags widget
  function extractAndRenderTags() {
    if (!popularTags) return;
    
    const allTags = {};
    
    // Extract tags from all forum sections
    forumSections.forEach(section => {
      if (section.tags && Array.isArray(section.tags)) {
        section.tags.forEach(tag => {
          if (!allTags[tag]) {
            allTags[tag] = 1;
          } else {
            allTags[tag]++;
          }
        });
      }
    });
    
    // Convert to array and sort by count
    const sortedTags = Object.entries(allTags)
      .map(([name, count]) => ({ name, count }))
      .sort((a, b) => b.count - a.count)
      .slice(0, 8); // Get top 8 tags
    
    // Render in popular tags widget
    popularTags.innerHTML = '';
    
    sortedTags.forEach(tag => {
      const tagElement = document.createElement('div');
      tagElement.className = 'tag-item';
      tagElement.setAttribute('role', 'button');
      tagElement.setAttribute('tabindex', '0');
      tagElement.setAttribute('data-tag', tag.name);
      tagElement.innerHTML = `${tag.name} <span class="tag-count">${tag.count}</span>`;
      
      popularTags.appendChild(tagElement);
    });
    
    // Setup listeners for these tag elements
    setupTagListeners();
  }
  
  // Setup event listeners for tag filtering
  function setupTagListeners() {
    document.querySelectorAll('.tag-item').forEach(element => {
      element.addEventListener('click', function(e) {
        e.preventDefault();
        currentTag = this.getAttribute('data-tag');
        filterForumSectionsByTag(currentTag);
        
        // Log event
        logEvent(analytics, 'select_content', {
          content_type: 'tag',
          content_id: currentTag
        });
      });
      
      // Keyboard accessibility
      element.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          this.click();
        }
      });
    });
  }
  
  // Render forum content based on categories and sections
  function renderForumContent() {
    if (!forumCategoriesContainer) return;
    
    // Clear existing content
    forumCategoriesContainer.innerHTML = '';
    
    // For each category, create a container and add relevant sections
    forumCategories.forEach(category => {
      const categoryElement = document.createElement('div');
      categoryElement.className = 'category';
      
      // Create category header
      const categoryHeader = document.createElement('div');
      categoryHeader.className = 'category-header';
      
      categoryHeader.innerHTML = `
        <h2>${category.name}</h2>
        <i class="fas fa-chevron-down"></i>
      `;
      
      // Create category body
      const categoryBody = document.createElement('div');
      categoryBody.className = 'category-body';
      
      // Only show rewritten articles in 'actueel' category
      if (category.id === 'actueel') {
        // Make sure the 'actueel' category is expanded by default
        categoryBody.style.display = 'block';
        categoryHeader.querySelector('i').classList.remove('fa-chevron-right');
        categoryHeader.querySelector('i').classList.add('fa-chevron-down');
        
        // Fetch rewritten articles from Firestore
        const articlesRef = collection(firestore, 'articles_rewritten');
        console.log('🔍 Attempting to fetch articles from Firestore...');
        
        getDocs(articlesRef).then(snapshot => {
          console.log(`✅ Successfully fetched ${snapshot.docs.length} rewritten articles from Firestore`);
          if (snapshot.docs.length === 0) {
            console.log('⚠️ No articles found in Firestore, showing message');
            const noArticlesElement = document.createElement('div');
            noArticlesElement.className = 'article featured-article';
            noArticlesElement.innerHTML = `
              <div class="featured-badge">Info</div>
              
              <div class="article-content">
                  
                <div class="article-categories">
                    <button class="article-category" type="button">Systeem</button>
                </div>
                
                  <h3 id="article-title-info">Geen artikelen gevonden</h3>
                  
                <div class="article-meta">
                    <div class="article-date">
                        <i class="far fa-calendar-alt" aria-hidden="true"></i> ${new Date().toLocaleDateString('nl-NL')} om ${new Date().toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit' })}
                    </div>
                    <div class="reading-time">
                        <i class="far fa-clock" aria-hidden="true"></i> 1 min leestijd
                    </div>
                </div>
                
                  <p>Er zijn nog geen artikelen beschikbaar. Gebruik de news-ripper om artikelen toe te voegen.</p>
                  <div class="article-actions">
                      <button class="read-more" onclick="location.reload()">Vernieuwen</button>
                      
                    <div class="article-tags">
                        <button class="article-tag" type="button">Info</button>
                        <button class="article-tag" type="button">Systeem</button>
                    </div>
                    
                  </div>
                  
              </div>
            `;
            categoryBody.appendChild(noArticlesElement);
          } else {
            snapshot.docs.forEach((doc, index) => {
              const article = doc.data();
              console.log(`📄 Processing article: ${article.title || 'No title'}`);
              const articleElement = document.createElement('div');
              articleElement.className = 'article featured-article';
              articleElement.setAttribute('tabindex', '0');
              articleElement.setAttribute('role', 'article');
              articleElement.setAttribute('aria-labelledby', `article-title-${index}`);
              
              // Generate article URL for internal site
              const articleSlug = article.title ? article.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '') : 'artikel';
              const articleUrl = `https://politie-forum.nl/article/${articleSlug}`;
              
              // Generate 3-sentence preview
              let articlePreview = '';
              if (article.full_text) {
                // Split by sentences and take first 3
                const sentences = article.full_text.match(/[^\.!?]+[\.!?]+/g) || [];
                articlePreview = sentences.slice(0, 3).join(' ').trim();
                if (sentences.length > 3) {
                  articlePreview += '...';
                }
              }
              if (!articlePreview) {
                articlePreview = article.preview || article.summary || 'Lees het volledige artikel...';
              }
              
              // Format date with robust timestamp handling
              let articleDate;
              try {
                if (article.timestamp) {
                  // Handle Firestore Timestamp format
                  if (article.timestamp.seconds) {
                    articleDate = new Date(article.timestamp.seconds * 1000);
                  }
                  // Handle regular timestamp
                  else if (typeof article.timestamp === 'number') {
                    articleDate = new Date(article.timestamp);
                  }
                  // Handle string dates
                  else if (typeof article.timestamp === 'string') {
                    articleDate = new Date(article.timestamp);
                  }
                  // Handle Date objects
                  else {
                    articleDate = new Date(article.timestamp);
                  }
                  
                  // Validate the date
                  if (isNaN(articleDate.getTime())) {
                    console.warn('Invalid timestamp for article:', article.title, 'using current date');
                    articleDate = new Date();
                  }
                } else {
                  articleDate = new Date();
                }
              } catch (error) {
                console.error('Error parsing timestamp for article:', article.title, error);
                articleDate = new Date();
              }
              
              const formattedDate = articleDate.toLocaleDateString('nl-NL', { 
                day: 'numeric', 
                month: 'long', 
                year: 'numeric' 
              }) + ' om ' + articleDate.toLocaleTimeString('nl-NL', { 
                hour: '2-digit', 
                minute: '2-digit' 
              });
              
              // Calculate reading time
              const readingTime = Math.max(1, Math.ceil((article.full_text || '').split(' ').length / 200));
              
              // Get article tags (use default if not available)
              const articleTags = article.tags || ['Politie', 'Nieuws', 'Nederland'];
              
              articleElement.innerHTML = `
                <div class="featured-badge">Uitgelicht</div>
                
                <div class="article-content">
                    
                  <div class="article-categories">
                      <button class="article-category" type="button">${article.category || 'Politie'}</button>
                  </div>
                  
                    <h3 id="article-title-${index}"><a href="${articleUrl}" class="article-title-link" target="_blank" rel="noopener noreferrer">${article.title || 'Nieuwsartikel'}</a></h3>
                    
                  <div class="article-meta">
                      <div class="article-date">
                          <i class="far fa-calendar-alt" aria-hidden="true"></i> ${formattedDate}
                      </div>
                      <div class="reading-time">
                          <i class="far fa-clock" aria-hidden="true"></i> ${readingTime} min leestijd
                      </div>
                  </div>
                  
                    <p>${articlePreview}</p>
                    <div class="article-actions">
                        <a href="${articleUrl}" class="read-more">Lees meer</a>
                        
                      <div class="article-tags">
                          ${articleTags.map(tag => `<button class="article-tag" type="button">${tag}</button>`).join('')}
                      </div>
                      
                    </div>
                    
                  <div class="share-buttons">
                      <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(articleUrl)}" target="_blank" rel="noopener noreferrer nofollow" class="share-btn facebook-share" aria-label="Deel op Facebook">
                          <i class="fab fa-facebook-f" aria-hidden="true"></i> Delen
                      </a>
                      <a href="https://twitter.com/intent/tweet?text=${encodeURIComponent(article.title || 'Nieuwsartikel')}&url=${encodeURIComponent(articleUrl)}" target="_blank" rel="noopener noreferrer nofollow" class="share-btn twitter-share" aria-label="Deel op Twitter">
                          <i class="fab fa-twitter" aria-hidden="true"></i> Tweet
                      </a>
                      <a href="https://wa.me/?text=${encodeURIComponent((article.title || 'Nieuwsartikel') + ' ' + articleUrl)}" target="_blank" rel="noopener noreferrer nofollow" class="share-btn whatsapp-share" aria-label="Deel via WhatsApp">
                          <i class="fab fa-whatsapp" aria-hidden="true"></i> WhatsApp
                      </a>
                      <a href="https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(articleUrl)}&title=${encodeURIComponent(article.title || 'Nieuwsartikel')}" target="_blank" rel="noopener noreferrer nofollow" class="share-btn linkedin-share" aria-label="Deel op LinkedIn">
                          <i class="fab fa-linkedin-in" aria-hidden="true"></i> LinkedIn
                      </a>
                      <a href="mailto:?subject=${encodeURIComponent(article.title || 'Nieuwsartikel')}&body=${encodeURIComponent((article.title || 'Nieuwsartikel') + '\n\n' + articleUrl)}" class="share-btn email-share" aria-label="Deel via e-mail">
                          <i class="far fa-envelope" aria-hidden="true"></i> E-mail
                      </a>
                  </div>
                  
                </div>
              `;
              categoryBody.appendChild(articleElement);
            });
          }
        }).catch(error => {
          console.error('❌ Error fetching rewritten articles from Firestore:', error);
          console.error('Error details:', error.code, error.message);
          // Add error message to the UI
          const errorElement = document.createElement('div');
          errorElement.className = 'article featured-article';
          errorElement.innerHTML = `
            <div class="featured-badge">Fout</div>
            
            <div class="article-content">
                
              <div class="article-categories">
                  <button class="article-category" type="button">Systeem</button>
              </div>
              
                <h2 id="article-title-error"><span style="color: red;">Fout bij laden artikelen</span></h2>
                
              <div class="article-meta">
                  <div class="article-date">
                      <i class="far fa-calendar-alt" aria-hidden="true"></i> ${new Date().toLocaleDateString('nl-NL')} om ${new Date().toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit' })}
                  </div>
                  <div class="reading-time">
                      <i class="far fa-clock" aria-hidden="true"></i> 1 min leestijd
                  </div>
              </div>
              
                <h3>Er is een fout opgetreden bij het laden van de artikelen. Controleer de console voor meer details.</h3>
                <div class="article-actions">
                    <button class="read-more" onclick="location.reload()">Probeer opnieuw</button>
                    
                  <div class="article-tags">
                      <button class="article-tag" type="button">Fout</button>
                      <button class="article-tag" type="button">Systeem</button>
                  </div>
                  
                </div>
                
            </div>
          `;
          categoryBody.appendChild(errorElement);
        });
      } else {
        // Filter sections for this category
        const categorySections = forumSections.filter(section => section.categoryId === category.id);
        
        // Add each section to the category body
        categorySections.forEach(section => {
          const sectionElement = document.createElement('div');
          sectionElement.className = 'forum-section';
          
          sectionElement.innerHTML = `
            <a href="/forum/${section.id}" class="forum-section-link" data-section-id="${section.id}">
              <div class="forum-icon">
                <i class="${section.icon}"></i>
              </div>
              <div class="forum-content">
                <div class="forum-title">${section.title}</div>
                <div class="forum-description">${section.description}</div>
                <div class="forum-stats">
                  <div class="forum-stat">
                    <i class="fas fa-comments"></i> ${section.postCount} berichten
                  </div>
                  <div class="forum-stat">
                    <i class="fas fa-file-alt"></i> ${section.topicCount} topics
                  </div>
                </div>
              </div>
              <div class="forum-latest">
                <div class="latest-post">${section.latestPost.title}</div>
                <div class="latest-time">${section.latestPost.time}</div>
              </div>
            </a>
          `;
          
          categoryBody.appendChild(sectionElement);
        });
      }
      
      // Add header and body to category element
      categoryElement.appendChild(categoryHeader);
      categoryElement.appendChild(categoryBody);
      
      // Add the completed category to the forum container
      forumCategoriesContainer.appendChild(categoryElement);
      
      // Add toggle functionality to this category
      categoryHeader.addEventListener('click', function() {
        // Toggle body visibility
        const isVisible = categoryBody.style.display !== 'none';
        
        if (isVisible) {
          categoryBody.style.display = 'none';
          this.querySelector('i').classList.remove('fa-chevron-down');
          this.querySelector('i').classList.add('fa-chevron-right');
        } else {
          categoryBody.style.display = 'block';
          this.querySelector('i').classList.remove('fa-chevron-right');
          this.querySelector('i').classList.add('fa-chevron-down');
        }
      });
    });
  }
  
  // Filter forum sections by location and category
  function filterForumSections() {
    let filteredSections = [...forumSections];
    
    // Apply location filter if not 'all'
    if (currentLocation !== 'all') {
      filteredSections = filteredSections.filter(section => 
        section.location === currentLocation
      );
    }
    
    // Apply category filter if not 'all'
    if (currentCategory !== 'all') {
      filteredSections = filteredSections.filter(section => 
        section.categoryId === currentCategory
      );
    }
    
    // Group by category for display
    const sectionsByCategory = {};
    
    filteredSections.forEach(section => {
      const categoryId = section.categoryId;
      if (!sectionsByCategory[categoryId]) {
        sectionsByCategory[categoryId] = [];
      }
      sectionsByCategory[categoryId].push(section);
    });
    
    // Update the UI to show only filtered sections
    updateFilteredUI(sectionsByCategory);
  }
  
  // Filter forum sections by tag
  function filterForumSectionsByTag(tag) {
    let filteredSections = forumSections.filter(section => 
      section.tags && section.tags.includes(tag)
    );
    
    // Group by category for display
    const sectionsByCategory = {};
    
    filteredSections.forEach(section => {
      const categoryId = section.categoryId;
      if (!sectionsByCategory[categoryId]) {
        sectionsByCategory[categoryId] = [];
      }
      sectionsByCategory[categoryId].push(section);
    });
    
    // Update the UI to show only tagged sections
    updateFilteredUI(sectionsByCategory);
  }
  
  // Update UI to show filtered sections
  function updateFilteredUI(sectionsByCategory) {
    if (!forumCategoriesContainer) return;
    
    // Clear existing content
    forumCategoriesContainer.innerHTML = '';
    
    // Show message if no results
    if (Object.keys(sectionsByCategory).length === 0) {
      const noResults = document.createElement('div');
      noResults.className = 'no-results';
      noResults.innerHTML = `
        <div class="article" style="padding: 2rem; text-align: center;">
          <h2>Geen resultaten gevonden</h2>
          <p>Er zijn geen forumcategorieën die aan je filters voldoen.</p>
          <button class="auth-btn" id="resetFilters" style="max-width: 200px; margin: 1rem auto;">Filters resetten</button>
        </div>
      `;
      
      forumCategoriesContainer.appendChild(noResults);
      
      // Add reset button functionality
      document.getElementById('resetFilters').addEventListener('click', function() {
        currentLocation = 'all';
        currentCategory = 'all';
        currentTag = null;
        renderForumContent();
      });
      
      return;
    }
    
    // For each category that has sections, create a container
    for (const categoryId in sectionsByCategory) {
      // Find category info
      const category = forumCategories.find(cat => cat.id === categoryId);
      if (!category) continue;
      
      const categoryElement = document.createElement('div');
      categoryElement.className = 'category';
      
      // Create category header
      const categoryHeader = document.createElement('div');
      categoryHeader.className = 'category-header';
      
      categoryHeader.innerHTML = `
        <h2>${category.name}</h2>
        <i class="fas fa-chevron-down"></i>
      `;
      
      // Create category body
      const categoryBody = document.createElement('div');
      categoryBody.className = 'category-body';
      
      // Add each section to the category body
      sectionsByCategory[categoryId].forEach(section => {
        const sectionElement = document.createElement('div');
        sectionElement.className = 'forum-section';
        
        sectionElement.innerHTML = `
          <a href="/forum/${section.id}" class="forum-section-link" data-section-id="${section.id}">
            <div class="forum-icon">
              <i class="${section.icon}"></i>
            </div>
            <div class="forum-content">
              <div class="forum-title">${section.title}</div>
              <div class="forum-description">${section.description}</div>
              <div class="forum-stats">
                <div class="forum-stat">
                  <i class="fas fa-comments"></i> ${section.postCount} berichten
                </div>
                <div class="forum-stat">
                  <i class="fas fa-file-alt"></i> ${section.topicCount} topics
                </div>
              </div>
            </div>
            <div class="forum-latest">
              <div class="latest-post">${section.latestPost.title}</div>
              <div class="latest-time">${section.latestPost.time}</div>
            </div>
          </a>
        `;
        
        categoryBody.appendChild(sectionElement);
      });
      
      // Add header and body to category element
      categoryElement.appendChild(categoryHeader);
      categoryElement.appendChild(categoryBody);
      
      // Add the completed category to the forum container
      forumCategoriesContainer.appendChild(categoryElement);
      
      // Add toggle functionality to this category
      categoryHeader.addEventListener('click', function() {
        // Toggle body visibility
        const isVisible = categoryBody.style.display !== 'none';
        
        if (isVisible) {
          categoryBody.style.display = 'none';
          this.querySelector('i').classList.remove('fa-chevron-down');
          this.querySelector('i').classList.add('fa-chevron-right');
        } else {
          categoryBody.style.display = 'block';
          this.querySelector('i').classList.remove('fa-chevron-right');
          this.querySelector('i').classList.add('fa-chevron-down');
        }
      });
    }
  }
  
  // Initialize all functionality when DOM is loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Update the news flasher with latest articles
    updateNewsFlasher();
    
    // Load and display the forum data
    loadForumData();
  });
  
} catch (error) {
  console.error("Error initializing Firebase:", error);
  
  // Display a user-friendly error message
  const errorElement = document.createElement('div');
  errorElement.className = 'auth-error';
  errorElement.style.display = 'block';
  errorElement.style.margin = '20px';
  errorElement.textContent = 'Er is een fout opgetreden bij het laden van het forum. Probeer het later opnieuw.';
  
  const forumContainer = document.querySelector('.forum-container');
  if (forumContainer) {
    forumContainer.prepend(errorElement);
  } else {
    document.querySelector('.content-area')?.prepend(errorElement);
  }
  
  // Add fallback news flasher with static content
  const flasherContent = document.querySelector('.flasher-content');
  if (flasherContent) {
    const defaultNews = [
      'Twee verdachten aangehouden na gewapende overval in Amsterdam-Zuid',
      'Politie waarschuwt voor nieuwe oplichtingstruc via WhatsApp',
      'Vermist meisje (8) gezocht in Amsterdam-Noord',
      'Grote drugsvangst in Rotterdamse haven', 
      'Inbraakgolf in Eindhoven: politie zoekt getuigen'
    ];
    
    // Clear existing content
    flasherContent.innerHTML = '';
    
    // Add each default news item
    defaultNews.forEach((title, index) => {
      const newsSpan = document.createElement('span');
      newsSpan.textContent = title;
      newsSpan.style.cursor = 'pointer';
      flasherContent.appendChild(newsSpan);
      
      // Add separator except after the last item
      if (index < defaultNews.length - 1) {
        const separator = document.createElement('span');
        separator.className = 'flasher-separator';
        separator.textContent = '•';
        flasherContent.appendChild(separator);
      }
    });
    
    // Clone content for seamless looping
    const contentClone = flasherContent.innerHTML;
    flasherContent.innerHTML += contentClone;
  }
}
</script>
<script>
// Dark mode functionality
document.addEventListener('DOMContentLoaded', function() {
  const darkModeToggle = document.getElementById('darkModeToggle');
  const darkModeIcon = document.getElementById('darkModeIcon');
  const darkModeText = document.getElementById('darkModeText');
  
  if (!darkModeToggle) return;
  
  // Function to update dark mode state and UI
  function toggleDarkMode(isDark) {
    // Update the document class
    if (isDark) {
      document.body.classList.add('dark-mode');
    } else {
      document.body.classList.remove('dark-mode');
    }
    
    // Update the toggle button UI
    if (darkModeIcon) {
      darkModeIcon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
    }
    
    if (darkModeText) {
      darkModeText.textContent = isDark ? 'Licht' : 'Donker';
    }
    
    // Save the preference to localStorage
    localStorage.setItem('darkMode', isDark ? 'dark' : 'light');
    console.log('Dark mode toggled:', isDark ? 'ON' : 'OFF');
  }
  
  // Check for saved preference
  const savedPreference = localStorage.getItem('darkMode');
  const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
  
  // Set initial state based on preference or system setting
  if (savedPreference === 'dark' || (!savedPreference && prefersDarkScheme.matches)) {
    toggleDarkMode(true);
  } else {
    toggleDarkMode(false);
  }
  
  // Add click event listener
  darkModeToggle.addEventListener('click', function() {
    const isDarkMode = document.body.classList.contains('dark-mode');
    toggleDarkMode(!isDarkMode);
  });
  
  // Listen for system preference changes
  prefersDarkScheme.addEventListener('change', function(e) {
    if (!localStorage.getItem('darkMode')) {
      // Only automatically change if user hasn't set a preference
      toggleDarkMode(e.matches);
    }
  });
});
</script>
</body>
</html>
